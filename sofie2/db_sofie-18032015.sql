-- MySQL dump 10.13  Distrib 5.5.30, for Linux (x86_64)
--
-- Host: localhost    Database: db_sofie
-- ------------------------------------------------------
-- Server version	5.5.30-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Current Database: `db_sofie`
--

/*!40000 DROP DATABASE IF EXISTS `db_sofie`*/;

CREATE DATABASE /*!32312 IF NOT EXISTS*/ `db_sofie` /*!40100 DEFAULT CHARACTER SET latin1 */;

USE `db_sofie`;

--
-- Table structure for table `migrations`
--

DROP TABLE IF EXISTS `migrations`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `migrations` (
  `migration` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `batch` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `migrations`
--

LOCK TABLES `migrations` WRITE;
/*!40000 ALTER TABLE `migrations` DISABLE KEYS */;
/*!40000 ALTER TABLE `migrations` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `suiviappel`
--

DROP TABLE IF EXISTS `suiviappel`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `suiviappel` (
  `DATEAPPEL` datetime DEFAULT NULL,
  `UNIQUEID` varchar(50) DEFAULT NULL,
  `BRANCHE` tinyint(4) DEFAULT NULL,
  `TELEPHONE` varchar(20) DEFAULT NULL,
  `INFO` text,
  `RESEAU` int(11) DEFAULT NULL,
  `MEDIA` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `suiviappel`
--

LOCK TABLES `suiviappel` WRITE;
/*!40000 ALTER TABLE `suiviappel` DISABLE KEYS */;
INSERT INTO `suiviappel` VALUES ('2015-03-02 16:05:21','1425313529.3',0,'93578670',NULL,1,0),('2015-03-02 16:05:25','1425313529.3',2,'93578670',NULL,2,0),('2015-03-02 16:19:25','1425314373.4',0,'93578670',NULL,1,0),('2015-03-02 16:19:29','1425314373.4',2,'93578670',NULL,2,0),('2015-03-02 17:50:01','1425319809.5',0,'93578670',NULL,1,0),('2015-03-02 17:50:05','1425319809.5',2,'93578670',NULL,2,0),('2015-03-02 17:55:36','1425320144.6',0,'93578970',NULL,1,0),('2015-03-02 17:55:40','1425320144.6',2,'93578970',NULL,2,0),('2015-03-02 18:24:41','1425321889.7',0,'93578970',NULL,1,0),('2015-03-02 18:24:45','1425321889.7',2,'93578970',NULL,2,0),('2015-03-02 18:25:12','1425321919.8',0,'93578970',NULL,1,0),('2015-03-02 18:25:15','1425321919.8',2,'93578970',NULL,2,0),('2015-03-02 18:58:36','1425323923.9',0,'93578970',NULL,1,0),('2015-03-02 18:58:39','1425323923.9',2,'93578970',NULL,2,0),('2015-03-02 18:59:02','1425323949.10',0,'93578970',NULL,1,0),('2015-03-02 18:59:05','1425323949.10',2,'93578970',NULL,2,0),('2015-03-02 19:02:01','1425324128.11',0,'93578970',NULL,1,0),('2015-03-02 19:02:04','1425324128.11',2,'93578970',NULL,2,0),('2015-03-02 19:27:14','1425325642.12',0,'93578970',NULL,1,0),('2015-03-02 19:27:18','1425325642.12',2,'93578970',NULL,2,0),('2015-03-02 19:29:00','1425325747.13',0,'93578970',NULL,1,0),('2015-03-02 19:29:03','1425325747.13',2,'93578970',NULL,2,0),('2015-03-02 19:32:12','1425325940.14',0,'93578970',NULL,1,0),('2015-03-02 19:32:16','1425325940.14',2,'93578970',NULL,2,0),('2015-03-02 19:35:48','1425326156.15',0,'93578970',NULL,1,0),('2015-03-02 19:35:52','1425326156.15',2,'93578970',NULL,2,0),('2015-03-02 19:39:34','1425326382.16',0,'93578970',NULL,1,0),('2015-03-02 19:39:38','1425326382.16',2,'93578970',NULL,2,0),('2015-03-03 08:55:27','1425374134.19',0,'93578970',NULL,1,0),('2015-03-03 08:55:31','1425374134.19',2,'93578970',NULL,2,0),('2015-03-03 09:01:15','1425374482.20',0,'93578970',NULL,1,0),('2015-03-03 09:01:19','1425374482.20',2,'93578970',NULL,2,0),('2015-03-03 09:20:07','1425375615.21',0,'93578970',NULL,1,0),('2015-03-03 09:20:11','1425375615.21',2,'93578970',NULL,2,0),('2015-03-03 10:07:56','1425378483.22',0,'93578970',NULL,1,0),('2015-03-03 10:07:59','1425378483.22',2,'93578970',NULL,2,0),('2015-03-03 10:08:10','1425378497.23',0,'93578970',NULL,1,0),('2015-03-03 10:08:14','1425378497.23',2,'93578970',NULL,2,0),('2015-03-03 10:10:01','1425378608.24',0,'93578970',NULL,1,0),('2015-03-03 10:10:05','1425378608.24',2,'93578970',NULL,2,0),('2015-03-03 10:23:38','1425379426.25',0,'93578970',NULL,1,0),('2015-03-03 10:23:42','1425379426.25',2,'93578970',NULL,2,0),('2015-03-03 10:29:39','1425379786.26',0,'93578970',NULL,1,0),('2015-03-03 10:29:42','1425379786.26',2,'93578970',NULL,2,0),('2015-03-03 10:31:19','1425379887.27',0,'93578970',NULL,1,0),('2015-03-03 10:31:23','1425379887.27',2,'93578970',NULL,2,0),('2015-03-03 10:35:27','1425380134.28',0,'93578670',NULL,1,0),('2015-03-03 10:35:31','1425380134.28',2,'93578670',NULL,2,0),('2015-03-03 10:36:02','1425380169.29',0,'93578670',NULL,1,0),('2015-03-03 10:36:06','1425380169.29',2,'93578670',NULL,2,0),('2015-03-03 13:51:53','1425391920.30',0,'93578670',NULL,1,0),('2015-03-03 13:51:57','1425391920.30',2,'93578670',NULL,2,0),('2015-03-03 14:08:30','1425392917.31',0,'93578670',NULL,1,0),('2015-03-03 14:08:34','1425392917.31',2,'93578670',NULL,2,0),('2015-03-03 14:09:36','1425392983.32',0,'93578670',NULL,1,0),('2015-03-03 14:09:40','1425392983.32',2,'93578670',NULL,2,0),('2015-03-03 14:12:29','1425393156.33',0,'93578670',NULL,1,0),('2015-03-03 14:12:33','1425393156.33',2,'93578670',NULL,2,0),('2015-03-03 14:12:46','1425393173.34',0,'93578670',NULL,1,0),('2015-03-03 14:12:50','1425393173.34',2,'93578670',NULL,2,0),('2015-03-03 14:22:52','1425393779.35',0,'93578672',NULL,1,0),('2015-03-03 14:22:56','1425393779.35',2,'93578672',NULL,2,0),('2015-03-03 14:36:51','1425394618.36',0,'93578672',NULL,1,0),('2015-03-03 14:36:55','1425394618.36',2,'93578672',NULL,2,0),('2015-03-03 14:39:20','1425394767.37',0,'93578672',NULL,1,0),('2015-03-03 14:39:24','1425394767.37',2,'93578672',NULL,2,0),('2015-03-03 14:41:15','1425394882.38',0,'93578670',NULL,1,0),('2015-03-03 14:41:19','1425394882.38',2,'93578670',NULL,2,0),('2015-03-03 14:42:28','1425394955.39',0,'93578670',NULL,1,0),('2015-03-03 14:42:31','1425394955.39',2,'93578670',NULL,2,0),('2015-03-03 14:44:57','1425395104.40',0,'93578670',NULL,1,0),('2015-03-03 14:45:01','1425395104.40',2,'93578670',NULL,2,0),('2015-03-03 14:48:29','1425395315.41',0,'93578670',NULL,1,0),('2015-03-03 14:48:32','1425395315.41',2,'93578670',NULL,2,0),('2015-03-03 14:48:52','1425395339.42',0,'93578670',NULL,1,0),('2015-03-03 14:48:55','1425395339.42',2,'93578670',NULL,2,0),('2015-03-03 14:55:37','1425395744.43',0,'93578670',NULL,1,0),('2015-03-03 14:55:41','1425395744.43',2,'93578670',NULL,2,0),('2015-03-03 14:55:58','1425395765.44',0,'93578670',NULL,1,0),('2015-03-03 14:56:02','1425395765.44',2,'93578670',NULL,2,0),('2015-03-03 14:57:53','1425395879.45',0,'93578970',NULL,1,0),('2015-03-03 14:57:56','1425395879.45',2,'93578970',NULL,2,0),('2015-03-03 14:58:54','1425395941.46',0,'93578970',NULL,1,0),('2015-03-03 14:58:58','1425395941.46',2,'93578970',NULL,2,0),('2015-03-03 15:06:58','1425396425.47',0,'93578970',NULL,1,0),('2015-03-03 15:07:01','1425396425.47',2,'93578970',NULL,2,0),('2015-03-03 15:08:34','1425396520.48',0,'93578670',NULL,1,0),('2015-03-03 15:08:37','1425396520.48',2,'93578670',NULL,2,0),('2015-03-03 15:09:47','1425396594.49',0,'93578970',NULL,1,0),('2015-03-03 15:10:14','1425396621.50',0,'93578670',NULL,1,0),('2015-03-03 15:10:17','1425396621.50',2,'93578670',NULL,2,0),('2015-03-03 15:11:05','1425396672.51',0,'93578970',NULL,1,0),('2015-03-03 15:11:08','1425396672.51',2,'93578970',NULL,2,0),('2015-03-03 16:12:32','1425400359.52',0,'93578670',NULL,1,0),('2015-03-03 16:12:35','1425400359.52',2,'93578670',NULL,2,0),('2015-03-03 16:13:14','1425400401.53',0,'93578670',NULL,1,0),('2015-03-03 16:13:17','1425400401.53',2,'93578670',NULL,2,0),('2015-03-03 16:15:13','1425400520.54',0,'93578970',NULL,1,0),('2015-03-03 16:15:17','1425400520.54',2,'93578970',NULL,2,0),('2015-03-03 16:18:07','1425400694.55',0,'93578670',NULL,1,0),('2015-03-03 16:18:11','1425400694.55',2,'93578670',NULL,2,0),('2015-03-03 16:18:26','1425400713.56',0,'93578670',NULL,1,0),('2015-03-03 16:18:30','1425400713.56',2,'93578670',NULL,2,0),('2015-03-03 16:19:15','1425400762.57',0,'93578970',NULL,1,0),('2015-03-03 16:19:19','1425400762.57',2,'93578970',NULL,2,0),('2015-03-03 16:24:23','1425401069.58',0,'93578970',NULL,1,0),('2015-03-03 16:24:26','1425401069.58',2,'93578970',NULL,2,0),('2015-03-03 16:24:55','1425401102.59',0,'93578970',NULL,1,0),('2015-03-03 16:24:59','1425401102.59',2,'93578970',NULL,2,0),('2015-03-03 16:28:53','1425401340.60',0,'93578970',NULL,1,0),('2015-03-03 16:28:56','1425401340.60',2,'93578970',NULL,2,0),('2015-03-03 16:39:32','1425401978.61',0,'93578970',NULL,1,0),('2015-03-03 16:39:35','1425401978.61',2,'93578970',NULL,2,0),('2015-03-03 16:41:29','1425402096.62',0,'93578670',NULL,1,0),('2015-03-03 16:41:33','1425402096.62',2,'93578670',NULL,2,0),('2015-03-03 16:41:52','1425402119.63',0,'93578670',NULL,1,0),('2015-03-03 16:41:56','1425402119.63',2,'93578670',NULL,2,0),('2015-03-03 16:42:49','1425402176.64',0,'93578970',NULL,1,0),('2015-03-03 16:42:53','1425402176.64',2,'93578970',NULL,2,0),('2015-03-03 16:48:44','1425402531.65',0,'93578670',NULL,1,0),('2015-03-03 16:48:48','1425402531.65',2,'93578670',NULL,2,0),('2015-03-03 16:49:05','1425402552.66',0,'93578670',NULL,1,0),('2015-03-03 16:49:08','1425402552.66',2,'93578670',NULL,2,0),('2015-03-03 16:50:03','1425402610.67',0,'93578970',NULL,1,0),('2015-03-03 16:50:07','1425402610.67',2,'93578970',NULL,2,0),('2015-03-03 16:58:58','1425403144.68',0,'93578970',NULL,1,0),('2015-03-03 16:59:01','1425403144.68',2,'93578970',NULL,2,0),('2015-03-03 16:59:28','1425403175.69',0,'93578670',NULL,1,0),('2015-03-03 16:59:31','1425403175.69',2,'93578670',NULL,2,0),('2015-03-03 16:59:55','1425403201.70',0,'93578670',NULL,1,0),('2015-03-03 16:59:58','1425403201.70',2,'93578670',NULL,2,0),('2015-03-03 17:00:50','1425403257.71',0,'93578970',NULL,1,0),('2015-03-03 17:00:53','1425403257.71',2,'93578970',NULL,2,0),('2015-03-03 17:10:58','1425403865.72',0,'93578672',NULL,1,0),('2015-03-03 17:11:01','1425403865.72',2,'93578672',NULL,2,0),('2015-03-03 17:11:56','1425403922.73',0,'93578672',NULL,1,0),('2015-03-03 17:11:59','1425403922.73',2,'93578672',NULL,2,0),('2015-03-03 17:13:19','1425404005.74',0,'93578672',NULL,1,0),('2015-03-03 17:13:22','1425404005.74',2,'93578672',NULL,2,0),('2015-03-03 17:14:21','1425404068.75',0,'93578670',NULL,1,0),('2015-03-03 17:14:24','1425404068.75',2,'93578670',NULL,2,0),('2015-03-03 17:16:35','1425404202.76',0,'93578670',NULL,1,0),('2015-03-03 17:16:39','1425404202.76',2,'93578670',NULL,2,0),('2015-03-03 17:17:42','1425404269.77',0,'93578672',NULL,1,0),('2015-03-03 17:17:46','1425404269.77',2,'93578672',NULL,2,0),('2015-03-03 17:28:04','1425404891.78',0,'93578672',NULL,1,0),('2015-03-03 17:28:07','1425404891.78',2,'93578672',NULL,2,0),('2015-03-03 17:28:43','1425404930.79',0,'93578672',NULL,1,0),('2015-03-03 17:28:47','1425404930.79',2,'93578672',NULL,2,0),('2015-03-03 17:29:39','1425404986.80',0,'93578672',NULL,1,0),('2015-03-03 17:29:43','1425404986.80',2,'93578672',NULL,2,0),('2015-03-03 18:53:29','1425410016.81',0,'93578670',NULL,1,0),('2015-03-03 18:53:32','1425410016.81',2,'93578670',NULL,2,0),('2015-03-06 18:21:36','1425667301.243',0,'93578670',NULL,1,0),('2015-03-06 18:21:40','1425667301.243',2,'93578670',NULL,2,0),('2015-03-06 18:23:17','1425667401.244',0,'93578670',NULL,1,0),('2015-03-06 18:23:20','1425667401.244',2,'93578670',NULL,2,0),('2015-03-06 18:27:17','1425667641.245',0,'93578670',NULL,1,0),('2015-03-06 18:27:21','1425667641.245',2,'93578670',NULL,2,0),('2015-03-06 18:31:02','1425667866.246',0,'93578670',NULL,1,0),('2015-03-06 18:31:06','1425667866.246',2,'93578670',NULL,2,0),('2015-03-07 16:06:07','1425745570.247',0,'93578970',NULL,1,0),('2015-03-07 16:06:10','1425745570.247',2,'93578970',NULL,2,0),('2015-03-07 16:09:12','1425745756.248',0,'93578672',NULL,1,0),('2015-03-07 16:09:16','1425745756.248',2,'93578672',NULL,2,0),('2015-03-07 17:37:14','1425751037.249',0,'93578670',NULL,1,0),('2015-03-07 17:37:17','1425751037.249',2,'93578670',NULL,2,0),('2015-03-07 17:37:47','1425751070.250',0,'93578670',NULL,1,0),('2015-03-07 17:37:50','1425751070.250',2,'93578670',NULL,2,0),('2015-03-07 17:49:25','1425751769.251',0,'93578672',NULL,1,0),('2015-03-07 17:49:29','1425751769.251',2,'93578672',NULL,2,0),('2015-03-07 17:50:43','1425751847.252',0,'93578672',NULL,1,0),('2015-03-07 17:50:47','1425751847.252',2,'93578672',NULL,2,0),('2015-03-07 17:53:29','1425752012.253',0,'93578672',NULL,1,0),('2015-03-07 17:53:32','1425752012.253',2,'93578672',NULL,2,0),('2015-03-07 18:02:17','1425752540.254',0,'93578672',NULL,1,0),('2015-03-07 18:02:21','1425752540.254',2,'93578672',NULL,2,0),('2015-03-07 18:02:50','1425752574.255',0,'93578672',NULL,1,0),('2015-03-07 18:02:54','1425752574.255',2,'93578672',NULL,2,0),('2015-03-07 18:07:32','1425752856.256',0,'93578672',NULL,1,0),('2015-03-07 18:07:36','1425752856.256',2,'93578672',NULL,2,0),('2015-03-07 18:17:13','1425753437.257',0,'93578672',NULL,1,0),('2015-03-07 18:17:17','1425753437.257',2,'93578672',NULL,2,0),('2015-03-07 18:17:55','1425753479.258',0,'93578970',NULL,1,0),('2015-03-07 18:17:59','1425753479.258',2,'93578970',NULL,2,0),('2015-03-07 18:42:21','1425754945.259',0,'93578970',NULL,1,0),('2015-03-07 18:42:25','1425754945.259',2,'93578970',NULL,2,0),('2015-03-07 18:43:35','1425755018.260',0,'93578970',NULL,1,0),('2015-03-07 18:43:38','1425755018.260',2,'93578970',NULL,2,0),('2015-03-07 18:46:16','1425755180.261',0,'93578672',NULL,1,0),('2015-03-07 18:46:20','1425755180.261',2,'93578672',NULL,2,0),('2015-03-07 18:46:30','1425755194.262',0,'93578672',NULL,1,0),('2015-03-07 18:46:34','1425755194.262',2,'93578672',NULL,2,0),('2015-03-07 18:47:36','1425755259.263',0,'93578670',NULL,1,0),('2015-03-07 18:47:39','1425755259.263',2,'93578670',NULL,2,0),('2015-03-07 18:48:17','1425755300.264',0,'93578670',NULL,1,0),('2015-03-07 18:48:20','1425755300.264',2,'93578670',NULL,2,0),('2015-03-07 18:48:44','1425755327.265',0,'93578670',NULL,1,0),('2015-03-07 18:48:47','1425755327.265',2,'93578670',NULL,2,0),('2015-03-07 18:49:55','1425755399.266',0,'93578970',NULL,1,0),('2015-03-07 18:49:59','1425755399.266',2,'93578970',NULL,2,0),('2015-03-07 18:52:15','1425755538.267',0,'93578970',NULL,1,0),('2015-03-07 18:52:18','1425755538.267',2,'93578970',NULL,2,0),('2015-03-07 19:13:33','1425756816.268',0,'93578970',NULL,1,0),('2015-03-07 19:13:37','1425756816.268',2,'93578970',NULL,2,0),('2015-03-08 16:37:10','1425833833.269',0,'93578670',NULL,1,0),('2015-03-08 16:37:14','1425833833.269',2,'93578670',NULL,2,0),('2015-03-08 16:37:53','1425833876.270',0,'93578670',NULL,1,0),('2015-03-08 16:37:57','1425833876.270',2,'93578670',NULL,2,0),('2015-03-08 16:38:29','1425833912.271',0,'93578670',NULL,1,0),('2015-03-08 16:38:33','1425833912.271',2,'93578670',NULL,2,0),('2015-03-08 16:39:16','1425833958.272',0,'93578670',NULL,1,0),('2015-03-08 16:39:19','1425833958.272',2,'93578670',NULL,2,0),('2015-03-08 16:40:23','1425834026.273',0,'93578670',NULL,1,0),('2015-03-08 16:40:27','1425834026.273',2,'93578670',NULL,2,0),('2015-03-08 16:41:13','1425834075.274',0,'93578670',NULL,1,0),('2015-03-08 16:41:16','1425834075.274',2,'93578670',NULL,2,0),('2015-03-08 16:41:37','1425834100.275',0,'93578670',NULL,1,0),('2015-03-08 16:41:41','1425834100.275',2,'93578670',NULL,2,0),('2015-03-08 16:46:15','1425834378.276',0,'93578670',NULL,1,0),('2015-03-08 16:46:19','1425834378.276',2,'93578670',NULL,2,0),('2015-03-08 16:47:32','1425834454.277',0,'93578670',NULL,1,0),('2015-03-08 16:47:35','1425834454.277',2,'93578670',NULL,2,0),('2015-03-08 16:48:07','1425834490.278',0,'93578670',NULL,1,0),('2015-03-08 16:48:11','1425834490.278',2,'93578670',NULL,2,0),('2015-03-08 16:48:37','1425834520.279',0,'93578670',NULL,1,0),('2015-03-08 16:48:41','1425834520.279',2,'93578670',NULL,2,0),('2015-03-08 16:57:59','1425835082.280',0,'93578670',NULL,1,0),('2015-03-08 16:58:03','1425835082.280',2,'93578670',NULL,2,0),('2015-03-08 16:58:35','1425835118.281',0,'93578970',NULL,1,0),('2015-03-08 16:58:39','1425835118.281',2,'93578970',NULL,2,0),('2015-03-08 16:59:34','1425835176.282',0,'93578670',NULL,1,0),('2015-03-08 16:59:37','1425835176.282',2,'93578670',NULL,2,0),('2015-03-08 17:00:14','1425835217.283',0,'93578970',NULL,1,0),('2015-03-08 17:00:18','1425835217.283',2,'93578970',NULL,2,0),('2015-03-08 17:06:33','1425835596.284',0,'93578970',NULL,1,0),('2015-03-08 17:06:37','1425835596.284',2,'93578970',NULL,2,0),('2015-03-08 17:48:36','1425838119.285',0,'93578670',NULL,1,0),('2015-03-08 17:48:40','1425838119.285',2,'93578670',NULL,2,0),('2015-03-13 12:52:09','1426252327.2',0,'93578654',NULL,1,0),('2015-03-13 12:52:12','1426252327.2',2,'93578654',NULL,2,0),('2015-03-13 12:53:25','1426252404.3',0,'93578654',NULL,1,0),('2015-03-13 12:53:29','1426252404.3',2,'93578654',NULL,2,0),('2015-03-13 15:21:41','1426261299.4',0,'93578654',NULL,1,0),('2015-03-13 15:21:44','1426261299.4',2,'93578654',NULL,2,0),('2015-03-13 15:22:14','1426261332.5',0,'93578654',NULL,1,0),('2015-03-13 15:22:17','1426261332.5',2,'93578654',NULL,2,0),('2015-03-13 15:33:47','1426262025.6',0,'93578654',NULL,1,0),('2015-03-13 15:33:50','1426262025.6',2,'93578654',NULL,2,0),('2015-03-13 15:36:26','1426262184.7',0,'93578654',NULL,1,0),('2015-03-13 15:36:29','1426262184.7',2,'93578654',NULL,2,0),('2015-03-13 15:40:34','1426262433.8',0,'93578654',NULL,1,0),('2015-03-13 15:40:38','1426262433.8',2,'93578654',NULL,2,0),('2015-03-13 15:59:49','1426263588.9',0,'93578654',NULL,1,0),('2015-03-13 15:59:53','1426263588.9',2,'93578654',NULL,2,0),('2015-03-13 16:12:06','1426264325.10',0,'93578654',NULL,1,0),('2015-03-13 16:12:10','1426264325.10',2,'93578654',NULL,2,0),('2015-03-13 16:17:20','1426264638.11',0,'93578654',NULL,1,0),('2015-03-13 16:17:23','1426264638.11',2,'93578654',NULL,2,0),('2015-03-13 16:18:33','1426264711.12',0,'93578654',NULL,1,0),('2015-03-13 16:18:37','1426264711.12',2,'93578654',NULL,2,0),('2015-03-13 16:20:31','1426264829.13',0,'93578654',NULL,1,0),('2015-03-13 16:20:34','1426264829.13',2,'93578654',NULL,2,0),('2015-03-13 16:33:35','1426265613.14',0,'93578654',NULL,1,0),('2015-03-13 16:33:38','1426265613.14',2,'93578654',NULL,2,0),('2015-03-13 16:37:32','1426265851.15',0,'93578654',NULL,1,0),('2015-03-13 16:37:36','1426265851.15',2,'93578654',NULL,2,0),('2015-03-13 16:39:55','1426265994.16',0,'93578654',NULL,1,0),('2015-03-13 16:39:59','1426265994.16',2,'93578654',NULL,2,0),('2015-03-13 16:40:10','1426266008.17',0,'93578654',NULL,1,0),('2015-03-13 16:40:13','1426266008.17',2,'93578654',NULL,2,0),('2015-03-13 16:40:49','1426266048.18',0,'93578654',NULL,1,0),('2015-03-13 16:40:53','1426266048.18',2,'93578654',NULL,2,0),('2015-03-13 16:42:48','1426266166.19',0,'93578654',NULL,1,0),('2015-03-13 16:42:51','1426266166.19',2,'93578654',NULL,2,0),('2015-03-13 16:57:49','1426267068.20',0,'93578654',NULL,1,0),('2015-03-13 16:57:53','1426267068.20',2,'93578654',NULL,2,0),('2015-03-13 17:04:42','1426267480.21',0,'93578654',NULL,1,0),('2015-03-13 17:04:45','1426267480.21',2,'93578654',NULL,2,0),('2015-03-13 17:08:10','1426267689.22',0,'93578654',NULL,1,0),('2015-03-13 17:08:14','1426267689.22',2,'93578654',NULL,2,0),('2015-03-13 17:12:29','1426267947.23',0,'93578654',NULL,1,0),('2015-03-13 17:12:33','1426267947.23',2,'93578654',NULL,2,0),('2015-03-14 11:18:23','1426333101.24',0,'93578654',NULL,1,0),('2015-03-14 11:18:26','1426333101.24',2,'93578654',NULL,2,0),('2015-03-14 11:30:35','1426333832.25',0,'93578654',NULL,1,0),('2015-03-14 11:30:38','1426333832.25',2,'93578654',NULL,2,0),('2015-03-14 11:33:19','1426333997.26',0,'93578654',NULL,1,0),('2015-03-14 11:33:23','1426333997.26',2,'93578654',NULL,2,0),('2015-03-14 11:33:49','1426334027.27',0,'93578654',NULL,1,0),('2015-03-14 11:33:52','1426334027.27',2,'93578654',NULL,2,0),('2015-03-14 11:35:40','1426334138.28',0,'93578654',NULL,1,0),('2015-03-14 11:35:44','1426334138.28',2,'93578654',NULL,2,0),('2015-03-14 11:41:06','1426334463.29',0,'93578654',NULL,1,0),('2015-03-14 11:41:09','1426334463.29',2,'93578654',NULL,2,0),('2015-03-14 11:41:48','1426334506.30',0,'93578654',NULL,1,0),('2015-03-14 11:41:52','1426334506.30',2,'93578654',NULL,2,0),('2015-03-14 12:29:25','1426337363.31',0,'93578654',NULL,1,0),('2015-03-14 12:29:29','1426337363.31',2,'93578654',NULL,2,0),('2015-03-14 12:33:08','1426337585.32',0,'93578672',NULL,1,0),('2015-03-14 12:33:11','1426337585.32',2,'93578672',NULL,2,0),('2015-03-14 12:34:21','1426337659.33',0,'93578672',NULL,1,0),('2015-03-14 12:34:25','1426337659.33',2,'93578672',NULL,2,0),('2015-03-14 12:38:47','1426337925.34',0,'93578672',NULL,1,0),('2015-03-14 12:38:51','1426337925.34',2,'93578672',NULL,2,0),('2015-03-14 12:40:05','1426338002.35',0,'93578672',NULL,1,0),('2015-03-14 12:40:08','1426338002.35',2,'93578672',NULL,2,0),('2015-03-14 12:48:32','1426338510.36',0,'93578672',NULL,1,0),('2015-03-14 12:48:36','1426338510.36',2,'93578672',NULL,2,0),('2015-03-14 12:49:19','1426338556.37',0,'93578672',NULL,1,0),('2015-03-14 12:49:22','1426338556.37',2,'93578672',NULL,2,0),('2015-03-14 12:49:29','1426338567.38',0,'93578672',NULL,1,0),('2015-03-14 12:49:33','1426338567.38',2,'93578672',NULL,2,0),('2015-03-14 12:50:22','1426338620.39',0,'93578672',NULL,1,0),('2015-03-14 12:50:26','1426338620.39',2,'93578672',NULL,2,0),('2015-03-14 13:09:26','1426339764.40',0,'93578672',NULL,1,0),('2015-03-14 13:09:30','1426339764.40',2,'93578672',NULL,2,0),('2015-03-17 15:57:33','1426609101.0',0,'93578654',NULL,1,0),('2015-03-17 15:57:36','1426609101.0',2,'93578654',NULL,2,0),('2015-03-17 16:00:27','1426609275.1',0,'93578654',NULL,1,0),('2015-03-17 16:00:30','1426609275.1',2,'93578654',NULL,2,0),('2015-03-17 18:33:47','1426618475.2',0,'93578654',NULL,1,0),('2015-03-17 18:33:50','1426618475.2',2,'93578654',NULL,2,0),('2015-03-17 18:35:05','1426618554.3',0,'93578654',NULL,1,0),('2015-03-17 18:35:09','1426618554.3',2,'93578654',NULL,2,0),('2015-03-17 18:35:42','1426618591.4',0,'93578654',NULL,1,0),('2015-03-17 18:35:45','1426618591.4',2,'93578654',NULL,2,0),('2015-03-17 18:52:09','1426619577.5',0,'93578654',NULL,1,0),('2015-03-17 18:52:12','1426619577.5',2,'93578654',NULL,2,0),('2015-03-17 18:58:47','1426619975.6',0,'93578670',NULL,1,0),('2015-03-17 18:58:50','1426619975.6',2,'93578670',NULL,2,0),('2015-03-17 18:58:51','1426619980.7',0,'93578670',NULL,1,0),('2015-03-17 18:58:55','1426619980.7',2,'93578670',NULL,2,0),('2015-03-17 19:21:36','1426621344.8',0,'93578670',NULL,1,0),('2015-03-17 19:21:39','1426621344.8',2,'93578670',NULL,2,0),('2015-03-17 19:21:50','1426621358.9',0,'93578670',NULL,1,0),('2015-03-17 19:21:53','1426621358.9',2,'93578670',NULL,2,0),('2015-03-17 19:24:36','1426621525.10',0,'93578670',NULL,1,0),('2015-03-17 19:24:40','1426621525.10',2,'93578670',NULL,2,0),('2015-03-17 19:46:08','1426622816.11',0,'93578670',NULL,1,0),('2015-03-17 19:46:11','1426622816.11',2,'93578670',NULL,2,0),('2015-03-17 19:47:34','1426622903.12',0,'93578654',NULL,1,0),('2015-03-17 19:47:38','1426622903.12',2,'93578654',NULL,2,0),('2015-03-17 19:58:53','1426623578.13',0,'93578654',NULL,1,0),('2015-03-17 19:59:54','1426623643.14',0,'93578654',NULL,1,0),('2015-03-17 19:59:58','1426623643.14',2,'93578654',NULL,2,0),('2015-03-17 20:00:41','1426623681.15',0,'93578654',NULL,1,0),('2015-03-17 20:01:44','1426623752.16',0,'93578654',NULL,1,0),('2015-03-17 20:01:47','1426623752.16',2,'93578654',NULL,2,0),('2015-03-17 20:04:31','1426623919.17',0,'93578654',NULL,1,0),('2015-03-17 20:04:37','1426623919.17',2,'93578654',NULL,2,0),('2015-03-17 20:05:24','1426623969.18',0,'93578654',NULL,1,0),('2015-03-17 20:05:36','1426623969.18',2,'93578654',NULL,2,0),('2015-03-17 20:11:54','1426624353.19',0,'93578654',NULL,1,0),('2015-03-17 20:11:57','1426624353.19',2,'93578654',NULL,2,0),('2015-03-17 20:16:10','1426624618.1',0,'93578654',NULL,1,0),('2015-03-17 20:21:26','1426624934.2',0,'93578654',NULL,1,0),('2015-03-17 20:21:38','1426624934.2',2,'93578654',NULL,2,0),('2015-03-17 20:22:43','1426625011.3',0,'93578654',NULL,1,0),('2015-03-17 20:22:49','1426625011.3',2,'93578654',NULL,2,0),('2015-03-17 20:24:27','1426625116.4',0,'93578654',NULL,1,0),('2015-03-17 20:24:40','1426625116.4',2,'93578654',NULL,2,0),('2015-03-17 20:31:43','1426625552.6',0,'93578654',NULL,1,0),('2015-03-17 20:44:00','1426626289.7',0,'93578654',NULL,1,0),('2015-03-17 20:44:04','1426626289.7',2,'93578654',NULL,2,0),('2015-03-17 20:45:16','1426626364.8',0,'93578654',NULL,1,0),('2015-03-17 20:45:19','1426626364.8',2,'93578654',NULL,2,0),('2015-03-17 20:47:16','1426626485.9',0,'93578654',NULL,1,0),('2015-03-17 20:47:41','1426626485.9',2,'93578654',NULL,2,0),('2015-03-17 20:47:45','1426626513.10',0,'93578654',NULL,1,0),('2015-03-17 20:47:48','1426626513.10',2,'93578654',NULL,2,0),('2015-03-17 20:49:01','1426626590.11',0,'93578654',NULL,1,0),('2015-03-17 20:49:05','1426626590.11',2,'93578654',NULL,2,0),('2015-03-17 20:51:52','1426626760.12',0,'93578670',NULL,1,0),('2015-03-17 20:52:04','1426626760.12',2,'93578670',NULL,2,0),('2015-03-17 20:54:10','1426626899.13',0,'93578672',NULL,1,0),('2015-03-17 20:54:14','1426626899.13',2,'93578672',NULL,2,0),('2015-03-17 20:55:58','1426627007.14',0,'93578672',NULL,1,0),('2015-03-17 20:56:02','1426627007.14',2,'93578672',NULL,2,0),('2015-03-17 20:57:54','1426627122.15',0,'93578670',NULL,1,0),('2015-03-17 20:57:57','1426627122.15',2,'93578670',NULL,2,0),('2015-03-17 20:59:16','1426627205.16',0,'93578672',NULL,1,0),('2015-03-17 20:59:20','1426627205.16',2,'93578672',NULL,2,0),('2015-03-17 21:00:11','1426627259.17',0,'93578672',NULL,1,0),('2015-03-17 21:00:15','1426627259.17',2,'93578672',NULL,2,0),('2015-03-17 21:08:35','1426627763.18',0,'93578672',NULL,1,0),('2015-03-17 21:08:38','1426627763.18',2,'93578672',NULL,2,0),('2015-03-17 21:09:46','1426627834.19',0,'93578672',NULL,1,0),('2015-03-17 21:09:49','1426627834.19',2,'93578672',NULL,2,0),('2015-03-17 21:15:15','1426628164.20',0,'93578672',NULL,1,0),('2015-03-17 21:15:19','1426628164.20',2,'93578672',NULL,2,0),('2015-03-17 21:21:43','1426628552.21',0,'93578672',NULL,1,0),('2015-03-17 21:21:47','1426628552.21',2,'93578672',NULL,2,0),('2015-03-17 21:26:54','1426628862.22',0,'93578672',NULL,1,0),('2015-03-17 21:26:57','1426628862.22',2,'93578672',NULL,2,0),('2015-03-17 21:28:17','1426628945.23',0,'93578672',NULL,1,0),('2015-03-17 21:28:20','1426628945.23',2,'93578672',NULL,2,0),('2015-03-17 21:29:59','1426629048.24',0,'93578670',NULL,1,0),('2015-03-17 21:30:03','1426629048.24',2,'93578670',NULL,2,0),('2015-03-17 21:35:57','1426629405.25',0,'93578670',NULL,1,0),('2015-03-17 21:36:00','1426629405.25',2,'93578670',NULL,2,0),('2015-03-17 21:36:41','1426629449.26',0,'93578670',NULL,1,0),('2015-03-17 21:36:44','1426629449.26',2,'93578670',NULL,2,0),('2015-03-17 21:37:25','1426629493.27',0,'93578672',NULL,1,0),('2015-03-17 21:37:28','1426629493.27',2,'93578672',NULL,2,0),('2015-03-17 21:38:14','1426629542.28',0,'93578670',NULL,1,0),('2015-03-17 21:38:17','1426629542.28',2,'93578670',NULL,2,0),('2015-03-18 09:31:16','1426672324.29',0,'93578672',NULL,1,0),('2015-03-18 09:31:20','1426672324.29',2,'93578672',NULL,2,0),('2015-03-18 09:31:45','1426672353.30',0,'93578672',NULL,1,0),('2015-03-18 09:31:49','1426672353.30',2,'93578672',NULL,2,0),('2015-03-18 09:50:53','1426673501.31',0,'93578672',NULL,1,0),('2015-03-18 09:50:57','1426673501.31',2,'93578672',NULL,2,0),('2015-03-18 10:12:00','1426674768.32',0,'93578672',NULL,1,0),('2015-03-18 10:12:04','1426674768.32',2,'93578672',NULL,2,0),('2015-03-18 10:16:16','1426675024.33',0,'93578672',NULL,1,0),('2015-03-18 10:16:20','1426675024.33',2,'93578672',NULL,2,0),('2015-03-18 10:18:59','1426675187.34',0,'93578672',NULL,1,0),('2015-03-18 10:19:02','1426675187.34',2,'93578672',NULL,2,0),('2015-03-18 10:23:49','1426675477.35',0,'93578672',NULL,1,0),('2015-03-18 10:23:52','1426675477.35',2,'93578672',NULL,2,0),('2015-03-18 10:36:09','1426676217.36',0,'93578672',NULL,1,0),('2015-03-18 10:36:13','1426676217.36',2,'93578672',NULL,2,0),('2015-03-18 10:39:11','1426676399.37',0,'93578672',NULL,1,0),('2015-03-18 10:39:14','1426676399.37',2,'93578672',NULL,2,0),('2015-03-18 10:39:38','1426676426.38',0,'93578672',NULL,1,0),('2015-03-18 10:39:42','1426676426.38',2,'93578672',NULL,2,0),('2015-03-18 11:38:21','1426679949.39',0,'93578672',NULL,1,0),('2015-03-18 11:38:25','1426679949.39',2,'93578672',NULL,2,0),('2015-03-18 11:43:37','1426680265.40',0,'93578672',NULL,1,0),('2015-03-18 11:43:41','1426680265.40',2,'93578672',NULL,2,0),('2015-03-18 11:44:20','1426680308.41',0,'93578670',NULL,1,0),('2015-03-18 11:44:24','1426680308.41',2,'93578670',NULL,2,0),('2015-03-18 11:45:08','1426680356.42',0,'93578670',NULL,1,0),('2015-03-18 11:45:12','1426680356.42',2,'93578670',NULL,2,0),('2015-03-18 11:46:22','1426680430.43',0,'93578670',NULL,1,0),('2015-03-18 11:46:25','1426680430.43',2,'93578670',NULL,2,0),('2015-03-18 11:46:35','1426680443.44',0,'93578670',NULL,1,0),('2015-03-18 11:46:39','1426680443.44',2,'93578670',NULL,2,0),('2015-03-18 11:47:30','1426680498.45',0,'93578970',NULL,1,0),('2015-03-18 11:47:33','1426680498.45',2,'93578970',NULL,2,0),('2015-03-18 11:49:50','1426680638.46',0,'93578672',NULL,1,0),('2015-03-18 11:49:54','1426680638.46',2,'93578672',NULL,2,0),('2015-03-18 11:51:02','1426680710.47',0,'93578672',NULL,1,0),('2015-03-18 11:51:05','1426680710.47',2,'93578672',NULL,2,0),('2015-03-18 11:53:23','1426680851.48',0,'93578670',NULL,1,0),('2015-03-18 11:53:26','1426680851.48',2,'93578670',NULL,2,0),('2015-03-18 12:51:48','1426684356.49',0,'93578670',NULL,1,0),('2015-03-18 12:51:52','1426684356.49',2,'93578670',NULL,2,0),('2015-03-18 12:54:17','1426684504.50',0,'93578670',NULL,1,0),('2015-03-18 12:54:20','1426684504.50',2,'93578670',NULL,2,0),('2015-03-18 12:59:13','1426684801.51',0,'93578670',NULL,1,0),('2015-03-18 12:59:16','1426684801.51',2,'93578670',NULL,2,0),('2015-03-18 13:02:05','1426684972.52',0,'93578670',NULL,1,0),('2015-03-18 13:02:08','1426684972.52',2,'93578670',NULL,2,0),('2015-03-18 13:34:05','1426686892.53',0,'93578670',NULL,1,0),('2015-03-18 13:34:08','1426686892.53',2,'93578670',NULL,2,0),('2015-03-18 13:35:06','1426686954.54',0,'93578672',NULL,1,0),('2015-03-18 13:35:09','1426686954.54',2,'93578672',NULL,2,0),('2015-03-18 13:35:52','1426687000.55',0,'93578670',NULL,1,0),('2015-03-18 13:35:56','1426687000.55',2,'93578670',NULL,2,0),('2015-03-18 13:36:59','1426687067.56',0,'93578670',NULL,1,0),('2015-03-18 13:37:02','1426687067.56',2,'93578670',NULL,2,0),('2015-03-18 13:38:19','1426687147.57',0,'93578970',NULL,1,0),('2015-03-18 13:38:23','1426687147.57',2,'93578970',NULL,2,0),('2015-03-18 13:39:56','1426687244.58',0,'93578672',NULL,1,0),('2015-03-18 13:40:00','1426687244.58',2,'93578672',NULL,2,0),('2015-03-18 13:46:24','1426687632.59',0,'93578672',NULL,1,0),('2015-03-18 13:46:28','1426687632.59',2,'93578672',NULL,2,0),('2015-03-18 13:48:05','1426687733.60',0,'93578672',NULL,1,0),('2015-03-18 13:48:08','1426687733.60',2,'93578672',NULL,2,0),('2015-03-18 14:02:45','1426688613.61',0,'93578672',NULL,1,0),('2015-03-18 14:02:48','1426688613.61',2,'93578672',NULL,2,0),('2015-03-18 14:26:52','1426690060.62',0,'93578672',NULL,1,0),('2015-03-18 14:26:56','1426690060.62',2,'93578672',NULL,2,0),('2015-03-18 14:30:37','1426690285.63',0,'93578672',NULL,1,0),('2015-03-18 14:30:40','1426690285.63',2,'93578672',NULL,2,0),('2015-03-18 15:16:59','1426693066.64',0,'93578672',NULL,1,0),('2015-03-18 15:17:02','1426693066.64',2,'93578672',NULL,2,0),('2015-03-18 15:21:22','1426693330.65',0,'93578670',NULL,1,0),('2015-03-18 15:21:25','1426693330.65',2,'93578670',NULL,2,0),('2015-03-18 15:23:26','1426693454.66',0,'93578970',NULL,1,0),('2015-03-18 15:23:29','1426693454.66',2,'93578970',NULL,2,0),('2015-03-18 15:24:28','1426693515.67',0,'93578672',NULL,1,0),('2015-03-18 15:24:31','1426693515.67',2,'93578672',NULL,2,0),('2015-03-18 15:45:31','1426694779.68',0,'93578670',NULL,1,0),('2015-03-18 15:47:30','1426694898.69',0,'93544697',NULL,1,0),('2015-03-18 15:47:33','1426694898.69',2,'93544697',NULL,2,0);
/*!40000 ALTER TABLE `suiviappel` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `t_agent`
--

DROP TABLE IF EXISTS `t_agent`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_agent` (
  `IDAgent` int(10) NOT NULL AUTO_INCREMENT,
  `NomAgent` varchar(50) DEFAULT NULL,
  `PrenomsAgent` varchar(50) DEFAULT NULL,
  `CodeInitAgent` varchar(5) NOT NULL,
  `Qualification` varchar(10) DEFAULT NULL,
  `QualificationAgent` varchar(25) NOT NULL,
  `IDNumAppel` int(11) DEFAULT NULL,
  `IDNumAppelNotification` int(11) DEFAULT NULL,
  `IDLocalite` int(4) DEFAULT NULL,
  `IDRegion` int(4) NOT NULL,
  `InitSatus` tinyint(4) DEFAULT '0',
  PRIMARY KEY (`IDAgent`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_agent`
--

LOCK TABLES `t_agent` WRITE;
/*!40000 ALTER TABLE `t_agent` DISABLE KEYS */;
INSERT INTO `t_agent` VALUES (1,'Kouakou','Janyn','31001','3','Agent Forma',76,76,NULL,1,1),(2,'DUPOND','ARMAND','31002','3','Agent Forma',85,85,NULL,1,1),(3,'SISSOKO','ARMAND','41001','4','Sociologue',86,86,NULL,1,1),(4,'AGANAHI','CLEMENT','51001','5','Directeur Regional',NULL,NULL,NULL,1,0),(5,'qwerty','wertyu','41002','4','Sociologue',NULL,NULL,NULL,1,0),(6,'ytdwewfhv','dsnmf,dnfn','41003','4','Sociologue',NULL,NULL,NULL,1,0),(7,'fkjlghf','fdmngdnj','41004','5','Directeur Regional',NULL,NULL,NULL,1,0);
/*!40000 ALTER TABLE `t_agent` ENABLE KEYS */;
UNLOCK TABLES;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`susie`@`%`*/ /*!50003 TRIGGER `t_agent_after_ins_tr` AFTER INSERT ON `t_agent`
  FOR EACH ROW
BEGIN
	
	IF NEW.Qualification=4 THEN
    	UPDATE `t_region` SET `t_region`.`IDSociologue`=NEW.`IDAgent` WHERE `t_region`.`IDRegion`=NEW.`IDRegion`;
    END IF;
    
    IF NEW.Qualification=5 THEN
    	UPDATE `t_region` SET `t_region`.`IDDR`=NEW.`IDAgent` WHERE `t_region`.`IDRegion`=NEW.`IDRegion`;
    END IF;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`susie`@`%`*/ /*!50003 TRIGGER `t_agent_before_upd_tr` AFTER UPDATE ON `t_agent`
  FOR EACH ROW
BEGIN
	IF NEW.`InitSatus`=0 THEN
    	DELETE FROM `t_numeroappel`
        WHERE `t_numeroappel`.`IDNumAppel`=NEW.`IDNumAppel`;
    END IF;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;

--
-- Table structure for table `t_appeltelephonique`
--

DROP TABLE IF EXISTS `t_appeltelephonique`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_appeltelephonique` (
  `IDAPPEL` int(4) NOT NULL AUTO_INCREMENT,
  `DateHeureAppel` datetime DEFAULT NULL,
  `MotifAppel` int(2) DEFAULT NULL,
  `IDPanne` int(4) DEFAULT NULL,
  `IDNumAppel` int(4) DEFAULT NULL,
  PRIMARY KEY (`IDAPPEL`),
  KEY `IDNumAppel` (`IDNumAppel`)
) ENGINE=InnoDB AUTO_INCREMENT=79 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_appeltelephonique`
--

LOCK TABLES `t_appeltelephonique` WRITE;
/*!40000 ALTER TABLE `t_appeltelephonique` DISABLE KEYS */;
INSERT INTO `t_appeltelephonique` VALUES (1,'2015-03-07 17:37:56',1,1,74),(2,'2015-03-07 18:48:23',1,2,74),(3,'2015-03-08 16:38:40',1,3,74),(4,'2015-03-08 16:59:46',1,4,74),(5,'2015-03-08 17:11:04',2,4,75),(6,'2015-03-08 17:17:26',2,4,75),(7,'2015-03-08 17:24:21',4,4,75),(8,'2015-03-08 17:48:44',2,0,74),(9,'2015-03-12 18:28:20',4,4,75),(10,'2015-03-12 18:28:20',2,4,75),(11,'2015-03-13 12:53:42',0,0,78),(12,'2015-03-13 15:37:21',0,0,0),(13,'2015-03-13 15:40:49',0,0,0),(14,'2015-03-13 15:45:58',0,0,0),(15,'2015-03-13 15:48:17',0,0,0),(16,'2015-03-13 15:58:27',0,0,82),(17,'2015-03-13 16:00:23',0,0,84),(20,'2015-03-14 12:33:33',5,0,76),(22,'2015-03-14 12:36:11',6,0,76),(23,'2015-03-14 12:39:23',5,0,76),(25,'2015-03-14 12:48:51',6,0,76),(26,'2015-03-14 12:49:51',5,0,76),(27,'2015-03-14 12:50:31',6,0,76),(28,'2015-03-17 15:58:08',5,0,84),(29,'2015-03-17 18:34:22',0,0,85),(30,'2015-03-17 18:52:46',5,0,85),(31,'2015-03-17 18:59:01',1,5,74),(32,'2015-03-17 19:22:00',2,0,74),(33,'2015-03-17 19:24:58',2,0,74),(34,'2015-03-17 19:46:30',1,6,74),(35,'2015-03-17 20:02:07',6,0,85),(36,'2015-03-17 20:52:22',2,0,74),(37,'2015-03-17 20:54:41',5,0,76),(38,'2015-03-17 20:58:00',1,7,74),(39,'2015-03-17 20:59:44',6,0,76),(40,'2015-03-17 21:00:41',5,0,76),(41,'2015-03-17 21:09:02',6,0,76),(42,'2015-03-17 21:10:20',5,0,76),(43,'2015-03-17 21:15:40',6,0,76),(44,'2015-03-17 21:22:11',5,0,76),(45,'2015-03-17 21:27:11',6,0,76),(46,'2015-03-17 21:28:49',5,0,76),(47,'2015-03-17 21:30:07',2,0,74),(48,'2015-03-17 21:36:04',1,8,74),(49,'2015-03-17 21:36:52',2,0,74),(50,'2015-03-17 21:37:42',6,0,76),(51,'2015-03-17 21:38:23',1,9,74),(52,'2015-03-18 09:32:53',5,0,76),(53,'2015-03-18 10:24:13',6,0,76),(54,'2015-03-18 10:36:52',5,0,76),(55,'2015-03-18 10:39:48',6,0,76),(56,'2015-03-18 11:38:59',5,0,76),(57,'2015-03-18 11:43:52',6,0,76),(58,'2015-03-18 11:45:17',2,0,74),(59,'2015-03-18 11:46:42',1,10,74),(60,'2015-03-18 11:48:15',4,10,75),(61,'2015-03-18 11:50:31',5,0,76),(62,'2015-03-18 11:53:32',2,0,74),(63,'2015-03-18 12:51:57',1,11,74),(64,'2015-03-18 12:54:27',2,0,74),(65,'2015-03-18 12:59:19',1,12,74),(66,'2015-03-18 13:02:14',2,0,74),(67,'2015-03-18 13:34:13',1,13,74),(68,'2015-03-18 13:35:22',6,0,76),(69,'2015-03-18 13:36:02',2,0,74),(70,'2015-03-18 13:37:17',1,14,74),(71,'2015-03-18 13:39:04',4,14,75),(72,'2015-03-18 13:48:23',5,14,76),(73,'2015-03-18 14:03:13',5,14,76),(74,'2015-03-18 14:27:17',5,14,76),(75,'2015-03-18 14:31:04',3,14,76),(76,'2015-03-18 15:18:01',5,14,76),(77,'2015-03-18 15:21:32',2,0,74),(78,'2015-03-18 15:47:54',0,0,86);
/*!40000 ALTER TABLE `t_appeltelephonique` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `t_comite`
--

DROP TABLE IF EXISTS `t_comite`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_comite` (
  `IDComite` int(10) NOT NULL AUTO_INCREMENT,
  `NomComite` varchar(50) DEFAULT NULL,
  `CodeInitComite` varchar(5) NOT NULL,
  `NomSecretaire` varchar(50) DEFAULT NULL,
  `PrenomsSecretaire` varchar(50) DEFAULT NULL,
  `IDNumAppel` int(4) DEFAULT NULL,
  `IDLocalite` int(4) DEFAULT NULL,
  `InitSatus` tinyint(2) DEFAULT '0',
  PRIMARY KEY (`IDComite`),
  UNIQUE KEY `CodeInitComite` (`CodeInitComite`),
  UNIQUE KEY `CodeInitComite_2` (`CodeInitComite`),
  UNIQUE KEY `IDNumAppel_2` (`IDNumAppel`),
  KEY `IDComite` (`IDComite`),
  KEY `IDNumAppel` (`IDNumAppel`),
  CONSTRAINT `t_IDNumAppel_fk` FOREIGN KEY (`IDNumAppel`) REFERENCES `t_numeroappel` (`IDNumAppel`) ON DELETE SET NULL
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_comite`
--

LOCK TABLES `t_comite` WRITE;
/*!40000 ALTER TABLE `t_comite` DISABLE KEYS */;
INSERT INTO `t_comite` VALUES (2,'Comite1','11001','Diet.','Fabien',74,NULL,1),(3,'Comite2','11002','Laurent','Blanc',NULL,NULL,0),(4,'Comite3','11003','Marc.','Jacobs',NULL,NULL,0);
/*!40000 ALTER TABLE `t_comite` ENABLE KEYS */;
UNLOCK TABLES;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`susie`@`%`*/ /*!50003 TRIGGER `t_comite_before_upd_tr` AFTER UPDATE ON `t_comite`
  FOR EACH ROW
BEGIN
	IF NEW.`InitSatus`=0 THEN
    	DELETE FROM `t_numeroappel`
        WHERE `t_numeroappel`.`IDNumAppel`=NEW.`IDNumAppel`;
    END IF;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;

--
-- Table structure for table `t_localite`
--

DROP TABLE IF EXISTS `t_localite`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_localite` (
  `IDLocalite` int(10) NOT NULL AUTO_INCREMENT,
  `NomLocalite` varchar(50) DEFAULT NULL,
  `NombreHabitant` int(4) DEFAULT NULL,
  `IDRegion` int(4) NOT NULL,
  `IDAgentForma` int(4) NOT NULL,
  `IDReparateur` int(4) NOT NULL,
  PRIMARY KEY (`IDLocalite`),
  KEY `IDAgentForma` (`IDAgentForma`,`IDReparateur`),
  KEY `IDReparateur` (`IDReparateur`),
  KEY `IDAgentForma_2` (`IDAgentForma`),
  CONSTRAINT `t_localite_fk` FOREIGN KEY (`IDAgentForma`) REFERENCES `t_agent` (`IDAgent`) ON UPDATE CASCADE,
  CONSTRAINT `t_localite_fk1` FOREIGN KEY (`IDReparateur`) REFERENCES `t_reparateur` (`IDReparateur`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_localite`
--

LOCK TABLES `t_localite` WRITE;
/*!40000 ALTER TABLE `t_localite` DISABLE KEYS */;
INSERT INTO `t_localite` VALUES (1,'TSEVIE',1343,1,1,16),(2,'TCHEKPO',1724,1,1,16),(3,'AKLAKOU',2474,1,1,16),(4,'ATAPKAME',3060,2,2,17),(7,'deerwr',0,1,1,17);
/*!40000 ALTER TABLE `t_localite` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `t_notification`
--

DROP TABLE IF EXISTS `t_notification`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_notification` (
  `IDNotification` int(4) DEFAULT NULL,
  `DateHeureNotif` datetime DEFAULT NULL,
  `MotifNotif` int(2) DEFAULT NULL,
  `IDPanne` int(4) DEFAULT NULL,
  `IDNumAppel` int(4) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_notification`
--

LOCK TABLES `t_notification` WRITE;
/*!40000 ALTER TABLE `t_notification` DISABLE KEYS */;
/*!40000 ALTER TABLE `t_notification` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `t_numeroappel`
--

DROP TABLE IF EXISTS `t_numeroappel`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_numeroappel` (
  `IDNumAppel` int(4) NOT NULL AUTO_INCREMENT,
  `NumAppel` varchar(12) NOT NULL,
  `IDProfile` int(4) NOT NULL,
  PRIMARY KEY (`IDNumAppel`),
  KEY `IDProfile` (`IDProfile`)
) ENGINE=InnoDB AUTO_INCREMENT=87 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_numeroappel`
--

LOCK TABLES `t_numeroappel` WRITE;
/*!40000 ALTER TABLE `t_numeroappel` DISABLE KEYS */;
INSERT INTO `t_numeroappel` VALUES (74,'93578670',1),(75,'93578970',2),(76,'93578672',3),(77,'93578673',3),(85,'93578654',3),(86,'93544697',4);
/*!40000 ALTER TABLE `t_numeroappel` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `t_ouvrage`
--

DROP TABLE IF EXISTS `t_ouvrage`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_ouvrage` (
  `IDOuvrage` int(4) NOT NULL AUTO_INCREMENT,
  `CodeOuvrage` varchar(5) DEFAULT NULL,
  `TypeOuvrage` varchar(50) DEFAULT NULL,
  `StatutOuvrage` varchar(10) DEFAULT NULL,
  `Statut` tinyint(4) DEFAULT '2',
  `StatutPanne` tinyint(4) NOT NULL DEFAULT '1',
  `DateMiseAjour` datetime DEFAULT NULL,
  `Latitude` float(8,3) DEFAULT NULL,
  `Longitude` float(8,3) DEFAULT NULL,
  `Altitude` float(8,3) DEFAULT NULL,
  `IDRegion` int(4) DEFAULT NULL,
  `IDLocalite` int(4) DEFAULT NULL,
  `IDComite` int(4) DEFAULT NULL,
  `IDReparateur` int(4) DEFAULT NULL,
  `IDAgentForma` int(4) DEFAULT NULL,
  `IDSociologue` int(4) DEFAULT NULL,
  `IDDR` int(4) DEFAULT NULL,
  `dateStatut` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`IDOuvrage`),
  UNIQUE KEY `CodeOuvrage` (`CodeOuvrage`),
  UNIQUE KEY `IDComite_2` (`IDComite`),
  UNIQUE KEY `IDComite_3` (`IDComite`),
  KEY `IDLocalite` (`IDLocalite`),
  KEY `IDComite` (`IDComite`),
  KEY `StatutOuvrage` (`StatutOuvrage`),
  KEY `StatutPanne` (`StatutPanne`),
  KEY `IDReparateur` (`IDReparateur`),
  KEY `t_ouvrage_fk1` (`IDAgentForma`),
  CONSTRAINT `t_ouvrage_fk` FOREIGN KEY (`IDReparateur`) REFERENCES `t_localite` (`IDReparateur`)
) ENGINE=InnoDB AUTO_INCREMENT=13 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_ouvrage`
--

LOCK TABLES `t_ouvrage` WRITE;
/*!40000 ALTER TABLE `t_ouvrage` DISABLE KEYS */;
INSERT INTO `t_ouvrage` VALUES (1,'11001','Forage','MARCHE',1,1,'2015-03-18 15:18:01',6.401,1.193,NULL,1,1,2,16,1,NULL,NULL,'2015-03-18 15:21:32'),(2,'11002','Forage','1',2,1,NULL,6.311,1.693,NULL,1,3,3,16,1,NULL,NULL,'2015-03-06 18:02:55'),(3,'11003','Forage','1',2,1,NULL,6.511,1.293,NULL,1,2,4,16,3,NULL,NULL,'2015-03-06 18:07:54'),(12,'11004','Forage','1',2,1,NULL,0.000,0.000,NULL,1,3,5,16,3,NULL,NULL,'2015-03-06 21:18:57');
/*!40000 ALTER TABLE `t_ouvrage` ENABLE KEYS */;
UNLOCK TABLES;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`susie`@`%`*/ /*!50003 TRIGGER `t_ouvrage_after_ins_tr` BEFORE INSERT ON `t_ouvrage`
  FOR EACH ROW
BEGIN

DECLARE IDREPARATEUR INTEGER(10);
DECLARE IDAGENTFORMAT INTEGER(10);

SELECT `t_localite`.`IDReparateur`,`t_localite`.`IDAgentForma`
INTO IDREPARATEUR,IDAGENTFORMAT 
FROM `t_localite`
WHERE `t_localite`.`IDLocalite`=NEW.IDLocalite;

	SET NEW.IDAgentForma=IDAGENTFORMAT;
    SET NEW.IDReparateur=IDREPARATEUR;
   
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;

--
-- Table structure for table `t_panne`
--

DROP TABLE IF EXISTS `t_panne`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_panne` (
  `IDPanne` int(4) NOT NULL AUTO_INCREMENT,
  `NumPanne` varchar(5) DEFAULT NULL,
  `DateApparution` datetime DEFAULT NULL,
  `DatePriseCharge` datetime DEFAULT NULL,
  `DateDebutRep` datetime DEFAULT NULL,
  `DateReparation` datetime DEFAULT NULL,
  `StatutPanne` tinyint(4) DEFAULT '2',
  `enCours` tinyint(1) NOT NULL DEFAULT '0',
  `IDOuvrage` int(4) NOT NULL DEFAULT '2',
  `IDComite` int(4) DEFAULT NULL,
  `ALERT` int(4) DEFAULT '0',
  PRIMARY KEY (`IDPanne`),
  KEY `IDOuvrage` (`IDOuvrage`)
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_panne`
--

LOCK TABLES `t_panne` WRITE;
/*!40000 ALTER TABLE `t_panne` DISABLE KEYS */;
INSERT INTO `t_panne` VALUES (1,'11166','2015-03-07 17:37:56',NULL,'2015-03-07 18:43:51','2015-03-18 15:21:32',1,0,1,2,0),(2,'12289','2015-03-07 18:48:23','2015-03-07 18:50:39','2015-03-07 18:52:31','2015-03-18 15:21:32',1,0,1,2,0),(3,'12212','2015-03-08 16:38:40',NULL,NULL,'2015-03-18 15:21:32',1,0,1,2,0),(4,'11410','2015-03-08 16:59:46','2015-03-12 18:28:20',NULL,'2015-03-18 15:21:32',1,0,1,2,0),(5,'16282','2015-03-17 18:59:01',NULL,NULL,'2015-03-18 15:21:32',1,0,1,2,0),(6,'19716','2015-03-17 19:46:30',NULL,NULL,'2015-03-18 15:21:32',1,0,1,2,0),(7,'15618','2015-03-17 20:58:00',NULL,NULL,'2015-03-18 15:21:32',1,0,1,2,0),(8,'11362','2015-03-17 21:36:04',NULL,NULL,'2015-03-18 15:21:32',1,0,1,2,0),(9,'13589','2015-03-17 21:38:23',NULL,NULL,'2015-03-18 15:21:32',1,0,1,2,0),(10,'12054','2015-03-18 11:46:42','2015-03-18 11:48:15',NULL,'2015-03-18 15:21:32',1,0,1,2,0),(11,'11715','2015-03-18 12:51:57',NULL,NULL,'2015-03-18 15:21:32',1,0,1,2,0),(12,'14110','2015-03-18 12:59:19',NULL,NULL,'2015-03-18 15:21:32',1,0,1,2,0),(13,'15455','2015-03-18 13:34:13',NULL,NULL,'2015-03-18 15:21:32',1,0,1,2,0),(14,'19850','2015-03-18 13:37:17','2015-03-18 13:39:04','2015-03-18 14:31:04','2015-03-18 15:21:32',2,0,1,2,0);
/*!40000 ALTER TABLE `t_panne` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `t_profile`
--

DROP TABLE IF EXISTS `t_profile`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_profile` (
  `IDProfile` int(4) NOT NULL,
  `Designation` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  PRIMARY KEY (`IDProfile`),
  UNIQUE KEY `IDProfile` (`IDProfile`),
  UNIQUE KEY `IDProfile_2` (`IDProfile`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci COMMENT='InnoDB free: 71680 kB';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_profile`
--

LOCK TABLES `t_profile` WRITE;
/*!40000 ALTER TABLE `t_profile` DISABLE KEYS */;
INSERT INTO `t_profile` VALUES (1,'Comite Eau'),(2,'Reparateur'),(3,'Agent Forma'),(4,'Sociologue'),(5,'Directeur Regional');
/*!40000 ALTER TABLE `t_profile` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `t_region`
--

DROP TABLE IF EXISTS `t_region`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_region` (
  `IDRegion` int(4) NOT NULL AUTO_INCREMENT,
  `NomRegion` varchar(50) DEFAULT NULL,
  `Superficie` decimal(8,0) DEFAULT NULL,
  `Stituation` varchar(50) DEFAULT NULL,
  `longitude` varchar(20) NOT NULL,
  `latitude` varchar(20) NOT NULL,
  `carte` varchar(100) NOT NULL,
  `zoom` int(2) NOT NULL,
  `maxZoom` int(2) NOT NULL,
  `IDDR` int(4) DEFAULT NULL,
  `IDSociologue` int(4) DEFAULT NULL,
  PRIMARY KEY (`IDRegion`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_region`
--

LOCK TABLES `t_region` WRITE;
/*!40000 ALTER TABLE `t_region` DISABLE KEYS */;
INSERT INTO `t_region` VALUES (1,'MARITIME',NULL,NULL,'1.2620382756717587','6.5169892305005455','cartes/maritime/entier',10,14,4,3),(2,'PLATEAUX',NULL,NULL,'1.0801119609888923','7.46215121832277','cartes/plateaux/entier',10,14,NULL,NULL),(3,'KARA',NULL,NULL,'0.8338517357314521','9.5470362757685514','cartes/kara/entier',10,14,NULL,NULL),(4,'SAVANES',NULL,NULL,'0.45471026451080043','10.500250788686436','cartes/savanes/entier',10,14,NULL,NULL),(5,'CENTRALE',0,NULL,'1.0212149257067344','8.6004970332821564','cartes/centrale/entier',10,14,NULL,NULL);
/*!40000 ALTER TABLE `t_region` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `t_reparateur`
--

DROP TABLE IF EXISTS `t_reparateur`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_reparateur` (
  `IDReparateur` int(10) NOT NULL AUTO_INCREMENT,
  `NomRep` varchar(50) DEFAULT NULL,
  `PrenomsRep` varchar(50) DEFAULT NULL,
  `CodeInitRep` varchar(5) NOT NULL,
  `IDNumAppel` int(4) DEFAULT '0',
  `IDLocalite` int(4) DEFAULT '0',
  `InitSatus` tinyint(2) DEFAULT '0',
  PRIMARY KEY (`IDReparateur`),
  UNIQUE KEY `CodeInitAgent` (`CodeInitRep`),
  UNIQUE KEY `CodeInitAgent_2` (`CodeInitRep`),
  UNIQUE KEY `CodeInitRep` (`CodeInitRep`),
  UNIQUE KEY `CodeInitRep_2` (`CodeInitRep`),
  UNIQUE KEY `CodeInitRep_3` (`CodeInitRep`),
  KEY `IDNumAppel` (`IDNumAppel`)
) ENGINE=InnoDB AUTO_INCREMENT=18 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_reparateur`
--

LOCK TABLES `t_reparateur` WRITE;
/*!40000 ALTER TABLE `t_reparateur` DISABLE KEYS */;
INSERT INTO `t_reparateur` VALUES (16,'TETE','BRUNO','21001',75,0,1),(17,'DURAND','Jacques','21002',0,0,0);
/*!40000 ALTER TABLE `t_reparateur` ENABLE KEYS */;
UNLOCK TABLES;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`susie`@`%`*/ /*!50003 TRIGGER `t_reparateur_after_upd_tr` AFTER UPDATE ON `t_reparateur`
  FOR EACH ROW
BEGIN
	IF NEW.`InitSatus`=0 THEN
    	DELETE FROM `t_numeroappel`
        WHERE `t_numeroappel`.`IDNumAppel`=NEW.`IDNumAppel`;
    END IF;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;

--
-- Table structure for table `t_statutpanne`
--

DROP TABLE IF EXISTS `t_statutpanne`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `t_statutpanne` (
  `id` tinyint(4) NOT NULL AUTO_INCREMENT,
  `libelleStatut` varchar(100) NOT NULL,
  `icone` varchar(200) NOT NULL,
  `couleur` varchar(10) NOT NULL,
  UNIQUE KEY `id` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `t_statutpanne`
--

LOCK TABLES `t_statutpanne` WRITE;
/*!40000 ALTER TABLE `t_statutpanne` DISABLE KEYS */;
INSERT INTO `t_statutpanne` VALUES (0,'En marche','images/green-pin1.png','Vert'),(1,'En marche','images/green-pin1.png','Vert'),(2,'En panne','images/red-pin1.png','Rouge'),(3,'Prise en charge','images/blue-pin1.png','Bleu'),(4,'En réparation','images/orange-pin1.png','Orange');
/*!40000 ALTER TABLE `t_statutpanne` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `users`
--

DROP TABLE IF EXISTS `users`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `users` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `created_at` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
  `updated_at` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
  `name` varchar(30) COLLATE utf8_unicode_ci NOT NULL,
  `email` varchar(100) COLLATE utf8_unicode_ci NOT NULL,
  `password` varchar(64) COLLATE utf8_unicode_ci NOT NULL,
  `admin` tinyint(1) NOT NULL DEFAULT '0',
  `remember_token` varchar(100) COLLATE utf8_unicode_ci DEFAULT NULL,
  `role` tinyint(2) NOT NULL,
  `IDRegion` int(4) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `users_name_unique` (`name`),
  UNIQUE KEY `users_email_unique` (`email`),
  KEY `role` (`role`),
  KEY `IDRegion` (`IDRegion`)
) ENGINE=InnoDB AUTO_INCREMENT=14 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `users`
--

LOCK TABLES `users` WRITE;
/*!40000 ALTER TABLE `users` DISABLE KEYS */;
INSERT INTO `users` VALUES (1,'2015-01-08 10:47:46','2015-01-08 10:47:46','azerty','test@sofie.tg','$2y$10$XCKZjPLZ8k3YaklkbFR.0uHlM3ubHPIhm7Pl8cVCAXIY3on0xobDa',0,NULL,0,0),(3,'2015-01-08 11:34:02','2015-01-08 18:18:16','honorat','test52@sofie.tg','$2y$10$Mch.IKBAeOUw/BBoWskMP.3lYW2eJx45VyIbnbeUreqAkbJp9d.wC',0,'HsZgGkbVN4xHhGZnhLFKikM8kTI5GB1oHjn36l3DPn7MWWVw9SKYpvyFVmb2',3,5),(4,'2015-01-08 12:08:41','2015-02-27 16:11:59','azertya','test56@sofie.tg','$2y$10$D3m6Eku/4JEXA8k55UfXJec8CaGfNbj8Vrkimu/njs16bBgMXP.vG',0,'AxqqqnPibYR0lVwyUheR5FdmbldeHUUurWor826APfH4i6LvRNjQr3yYMfrA',2,0),(5,'2015-01-08 12:11:10','2015-03-06 19:30:27','admin','test7@sofie.tg','$2y$10$f63AejsBIPStfjhJf2kf8uWToCHXv1SPeLTeLEbwe.NuxJT6iBbmO',1,'STEps8XIVy5bfJS3vmqxtYeA9MDp89gbaKy9aIZvSNQRc6fJlUiszMcZYkPe',1,0),(6,'2015-01-08 12:21:30','2015-01-08 12:21:30','zezzze','test70@sofie.tg','$2y$10$LQ8odNrPKJ8wiC2F8nbe9ewcH2e89u1PPrvakF30NVeN..4mIlC8a',0,NULL,3,2),(7,'2015-01-08 12:22:45','2015-01-08 12:22:45','zezzzep','test12@sofie.tg','$2y$10$BRe0k4aUmOHrBjAABthHJeZbSz7aAGtjmp4uFYsb71ejKwbuhAwyq',0,NULL,3,2),(9,'2015-01-08 12:26:32','2015-01-08 12:26:32','sdfdfdfi','test4004@sofie.tg','$2y$10$EEX6IBWSbq33gOsp12rFH..I0Ggwvpg5sXVbgBF93IX3yRw072Gf6',0,NULL,3,1),(10,'2015-01-08 13:07:42','2015-01-08 13:09:29','fabien','test5716@sofie.tg','$2y$10$0qrn1wfnIBpOZchFhQs1wO3UuKkknM4o2Tmo9hbWSADpWgYtbXSZK',0,'t4dPEOGsJNFhkUT9uwF5uWNsR2xLKk4gE7j5Ov4j8q5tjbio4ttBiEVBmXqx',3,2),(11,'2015-01-08 16:47:35','2015-01-08 16:47:35','azsrtt','test7907@sofie.tg','$2y$10$NywvlCM.WX4HWjIPU897luxnHCQnA.Fun.iLdWCMEZS/WS54d/MuC',1,NULL,1,0),(12,'2015-01-08 16:52:32','2015-01-08 16:52:32','azsfff','test4781@sofie.tg','$2y$10$1YIQxUjYX0I9C4zFxn6CCegyilZCRxShLc1zEnYIB0re5VJ/.g90q',0,NULL,2,0),(13,'2015-01-08 18:00:08','2015-01-08 21:50:32','honore','test9892@sofie.tg','$2y$10$16uTC4VHNOTWT8vmcrK.xeb.Pq3F08IyQ2p6dQKwxqIcBfrYiiWWS',0,'WprTYWhp494gHv3OjLDrVxRjjVbB1NaH2h8huO5KUFZQfcFp56k3l8eEF7EC',2,0);
/*!40000 ALTER TABLE `users` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Temporary table structure for view `v_forage_hors_delai_prise_charge`
--

DROP TABLE IF EXISTS `v_forage_hors_delai_prise_charge`;
/*!50001 DROP VIEW IF EXISTS `v_forage_hors_delai_prise_charge`*/;
SET @saved_cs_client     = @@character_set_client;
SET character_set_client = utf8;
/*!50001 CREATE TABLE `v_forage_hors_delai_prise_charge` (
  `CODE_FORAGE` tinyint NOT NULL,
  `StatutPanne` tinyint NOT NULL,
  `NomPrenomsAgent` tinyint NOT NULL,
  `NumAppel` tinyint NOT NULL,
  `ALERT` tinyint NOT NULL
) ENGINE=MyISAM */;
SET character_set_client = @saved_cs_client;

--
-- Temporary table structure for view `v_forage_hors_delai_reparation`
--

DROP TABLE IF EXISTS `v_forage_hors_delai_reparation`;
/*!50001 DROP VIEW IF EXISTS `v_forage_hors_delai_reparation`*/;
SET @saved_cs_client     = @@character_set_client;
SET character_set_client = utf8;
/*!50001 CREATE TABLE `v_forage_hors_delai_reparation` (
  `CODE_FORAGE` tinyint NOT NULL,
  `StatutPanne` tinyint NOT NULL,
  `NomPrenomsAgent` tinyint NOT NULL,
  `NumAppel` tinyint NOT NULL,
  `ALERT` tinyint NOT NULL
) ENGINE=MyISAM */;
SET character_set_client = @saved_cs_client;

--
-- Dumping routines for database 'db_sofie'
--
/*!50003 DROP FUNCTION IF EXISTS `f_checkAgentStatusByNumAppel` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_checkAgentStatusByNumAppel`(
        _NumAppel VARCHAR(12)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT `t_agent`.`InitSatus` FROM `t_agent` WHERE `t_agent`.`IDAgent`=f_getIDAgentByIDNumAppel(f_getIDNumappelByNumAppel(_NumAppel)));
  
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_checkIDOuvrage` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_checkIDOuvrage`(
        _CODEOUVRAGE INTEGER(4)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF(COUNT(*)>0,t_ouvrage.`IDOuvrage`,0) FROM `t_ouvrage` WHERE `t_ouvrage`.`CodeOuvrage`=_CODEOUVRAGE);
  
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_checkIDProfileByNumAppel` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_checkIDProfileByNumAppel`(
        _NumAppel VARCHAR(12)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF(COUNT(*)>0,`t_numeroappel`.`IDProfile`,0) FROM `t_numeroappel` WHERE `t_numeroappel`.`NumAppel`=_NumAppel);
  
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_checkProfileInit` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_checkProfileInit`(
        _NUM_APPEL VARCHAR(20),
        _INIT_CODE VARCHAR(10)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

DECLARE _INIT_RESULT INTEGER(2);

	IF(SUBSTR(_INIT_CODE,1,1)=1) THEN
		SET _INIT_RESULT = (SELECT IF(f_getNumAppelByIDNumAppel(`t_comite`.`IDNumAppel`)=_NUM_APPEL,1,0) FROM `t_comite` WHERE `t_comite`.`CodeInitComite`=_INIT_CODE);
    END IF;  
    
    IF(SUBSTR(_INIT_CODE,1,1)=2) THEN
		SET _INIT_RESULT = (SELECT IF(f_getNumAppelByIDNumAppel(`t_reparateur`.`IDNumAppel`)=_NUM_APPEL,1,0) FROM `t_reparateur`  WHERE `t_reparateur`.`CodeInitRep`=_INIT_CODE);
    END IF; 
    
    IF(SUBSTR(_INIT_CODE,1,1)>=3) THEN
		SET _INIT_RESULT = (SELECT IF(f_getNumAppelByIDNumAppel(`t_agent`.`IDNumAppel`)=_NUM_APPEL,1,0) FROM `t_agent` WHERE `t_agent`.`CodeInitAgent`=_INIT_CODE);
    END IF;

  RETURN (_INIT_RESULT);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_check_delai_prise_cde` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_check_delai_prise_cde`(
        DELAIS_ENJOURS INTEGER(11),
        _NUM_TICKET_PANNE INTEGER(11)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF((CAST(DATE_ADD(`t_panne`.`DateApparution`,INTERVAL DELAIS_ENJOURS DAY) AS DATE)) < (CAST(NOW() AS date)),1,0) AS RESULT

   FROM `t_panne` WHERE `t_panne`.`NumPanne`=_NUM_TICKET_PANNE AND ((t_panne.`StatutPanne` > 1)OR(t_panne.`StatutPanne` = 0)));
  
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_generateTicket` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_generateTicket`() RETURNS varchar(5) CHARSET latin1
    DETERMINISTIC
BEGIN

  RETURN (SELECT FLOOR((RAND() * 10000 + 10000)));
  
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getCodeOuvrageByIDOuvrage` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_getCodeOuvrageByIDOuvrage`(
        _IDOuvrage INTEGER(4)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT `t_ouvrage`.`CodeOuvrage` FROM `t_ouvrage` WHERE `t_ouvrage`.`IDOuvrage`=_IDOuvrage);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getForageStatusByIDOuvrage` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_getForageStatusByIDOuvrage`(
        _IDOUVRAGE VARCHAR(5)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF(COUNT(*)>0,2,1) AS FORAGE_STATUS
	FROM `t_ouvrage` WHERE (`t_ouvrage`.`IDOuvrage` = _IDOUVRAGE AND ((t_ouvrage.`StatutOuvrage` > 1)OR(t_ouvrage.StatutOuvrage = 0))));
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDAgentByIDNumAppel` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_getIDAgentByIDNumAppel`(
        _IDNUMAPPEL INTEGER(4)
    ) RETURNS int(4)
    DETERMINISTIC
BEGIN
  RETURN (SELECT `t_agent`.`IDAgent` FROM `t_agent` WHERE `t_agent`.`IDNumAppel`=_IDNUMAPPEL);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDAgentByIDNumAppelNotification` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_getIDAgentByIDNumAppelNotification`(
        _IDNUMAPPEL INTEGER(4)
    ) RETURNS int(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT `t_agent`.`IDAgent` FROM `t_agent` WHERE `t_agent`.`IDNumAppelNotification`=_IDNUMAPPEL);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDComiteByIDNumAppel` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_getIDComiteByIDNumAppel`(
        _IDNUMAPPEL INTEGER(4)
    ) RETURNS int(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT `t_comite`.`IDComite` FROM `t_comite` WHERE `t_comite`.`IDNumAppel`=_IDNUMAPPEL);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDComiteByIDOuvrage` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_getIDComiteByIDOuvrage`(
        _IDOUVRAGE INTEGER(4)
    ) RETURNS int(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT `t_ouvrage`.`IDComite` FROM `t_ouvrage` WHERE `t_ouvrage`.`IDOuvrage`=_IDOUVRAGE);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDLocaliteByCodeInit` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_getIDLocaliteByCodeInit`(
        _CODE_INIT VARCHAR(10)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT `t_agent`.`IDLocalite` FROM `t_agent` WHERE `t_agent`.`CodeInitAgent`=_CODE_INIT);
  
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDLocaliteByIDOuvrage` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_getIDLocaliteByIDOuvrage`(
        _IDOuvrage INTEGER(4)
    ) RETURNS int(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT `t_ouvrage`.`IDLocalite` FROM `t_ouvrage` WHERE `t_ouvrage`.`IDOuvrage`=_IDOuvrage);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDNumAppelByCodeInit` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_getIDNumAppelByCodeInit`(
        _CODE_INIT VARCHAR(10)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT `t_agent`.`IDNumAppel` FROM `t_agent` WHERE `t_agent`.`CodeInitAgent`=_CODE_INIT);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDNumappelByNumAppel` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_getIDNumappelByNumAppel`(
        _NumAppel VARCHAR(12)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF(COUNT(*)>0,`t_numeroappel`.`IDNumAppel`,0)  FROM `t_numeroappel` WHERE `t_numeroappel`.`NumAppel`=_NumAppel);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDOuvrageByCodeOuvrage` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_getIDOuvrageByCodeOuvrage`(
        _CODEOUVRAGE VARCHAR(5)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF(COUNT(*)>0,t_ouvrage.`IDOuvrage`,0) AS FORAGE_STATUS
	FROM `t_ouvrage` WHERE (`t_ouvrage`.`CodeOuvrage` = _CODEOUVRAGE));
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDOuvrageByIDComite` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_getIDOuvrageByIDComite`(
        _IDCOMITE VARCHAR(5)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF(COUNT(*)>0,`t_ouvrage`.`IDOuvrage`,0) AS IDOUVRAGE
	FROM `t_ouvrage` WHERE (`t_ouvrage`.`IDComite` = _IDCOMITE));
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDOuvrageByNumAppel` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_getIDOuvrageByNumAppel`(
        _NUMAPPEL VARCHAR(12)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF(COUNT(*)>0,`t_ouvrage`.`IDOuvrage`,0) AS FORAGE_STATUS
	FROM `t_ouvrage` WHERE (`t_ouvrage`.`IDComite` = `f_getIDComiteByIDNumAppel`(`f_getIDNumappelByNumAppel`(_NUMAPPEL))));
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDOuvrageByNumPanne` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_getIDOuvrageByNumPanne`(
        _NUMPANNE VARCHAR(5)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF(COUNT(*)>0,t_panne.`IDOuvrage`,0) AS FORAGE_STATUS
	FROM `t_panne` WHERE (`t_panne`.`NumPanne` = _NUMPANNE AND ((t_panne.`StatutPanne` > 1)OR(t_panne.StatutPanne = 0))));
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDOuvrageByNumPanne2` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_getIDOuvrageByNumPanne2`(
        _NUMPANNE VARCHAR(5)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF(COUNT(*)>0,t_panne.`IDOuvrage`,0) AS FORAGE_STATUS
	FROM `t_panne` WHERE (`t_panne`.`NumPanne` = _NUMPANNE AND ((t_panne.`StatutPanne` > 1)OR(t_panne.StatutPanne = 0))));
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDPanneByIDOuvrage` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_getIDPanneByIDOuvrage`(
        _IDOUVRAGE INTEGER(10)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF(COUNT(*)>0,t_panne.`IDPanne`,0) AS FORAGE_STATUS
	FROM `t_panne` WHERE (`t_panne`.`IDOuvrage` = _IDOUVRAGE AND ((t_panne.`StatutPanne` > 1)OR(t_panne.StatutPanne = 0))));
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDRegionByIDAgent` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_getIDRegionByIDAgent`(
        _CODEOUVRAGE VARCHAR(5)
    ) RETURNS int(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT IF(COUNT(*)>0,`t_localite`.`IDRegion`,0) FROM `t_localite`,`t_ouvrage` 
  WHERE 
  `t_localite`.`IDLocalite` =`t_ouvrage`.`IDLocalite`
  AND `t_ouvrage`.`IDOuvrage`=`f_getIDOuvrageByCodeOuvrage`(_CODEOUVRAGE));
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getIDReparateurByIDNumAppel` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `f_getIDReparateurByIDNumAppel`(
        _IDNUMAPPEL INTEGER(4)
    ) RETURNS int(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT `t_reparateur`.`IDReparateur` FROM `t_reparateur` WHERE `t_reparateur`.`IDNumAppel`=_IDNUMAPPEL);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getNumAppelByIDNumAppel` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_getNumAppelByIDNumAppel`(
        _IDNUMAPPEL INTEGER(4)
    ) RETURNS varchar(12) CHARSET latin1
    DETERMINISTIC
BEGIN

  RETURN (SELECT `t_numeroappel`.`NumAppel` FROM `t_numeroappel` WHERE `t_numeroappel`.`IDNumAppel` = _IDNUMAPPEL);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getPanneIdByPanneTicket` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` FUNCTION `f_getPanneIdByPanneTicket`(
        _PANNE INTEGER(10)
    ) RETURNS varchar(5) CHARSET latin1
    DETERMINISTIC
BEGIN
  RETURN (SELECT `t_panne`.`IDPanne` FROM `t_panne` WHERE `t_panne`.`NumPanne`= _PANNE);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getPanneTicket` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` FUNCTION `f_getPanneTicket`() RETURNS int(20)
    DETERMINISTIC
BEGIN
  RETURN (SELECT UNIX_TIMESTAMP(NOW()));
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_getPanneTicketByPanneId` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` FUNCTION `f_getPanneTicketByPanneId`(
        _IDPANNE INTEGER(4)
    ) RETURNS varchar(5) CHARSET latin1
    DETERMINISTIC
BEGIN
  RETURN (SELECT `t_panne`.`NumPanne` FROM `t_panne` WHERE `t_panne`.`IDPanne`= _IDPANNE);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `f_ifexist_num_panne` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` FUNCTION `f_ifexist_num_panne`(
        _NUM_TICKET_PANNE VARCHAR(5)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

DECLARE TICKET_PANNE_STATUS TINYINT(4);

	SELECT IF (COUNT(*)>0,`t_panne`.`StatutPanne`,0) INTO TICKET_PANNE_STATUS
	FROM `t_panne` WHERE (`t_panne`.`NumPanne` = _NUM_TICKET_PANNE AND ((t_panne.`StatutPanne` > 1)OR(t_panne.`StatutPanne` = 0)));
  RETURN TICKET_PANNE_STATUS;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP FUNCTION IF EXISTS `getIDProfileByNumAppel` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `getIDProfileByNumAppel`(
        _NumAppel VARCHAR(12)
    ) RETURNS tinyint(4)
    DETERMINISTIC
BEGIN

  RETURN (SELECT `t_numeroappel`.`IDProfile` FROM `t_numeroappel` WHERE `t_numeroappel`.`NumAppel`=_NumAppel);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `PROC_VERIF_PRISE_CDE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `PROC_VERIF_PRISE_CDE`(
        IN _NUM_TICKET_PANNE INTEGER(11),
        IN _NB_JOUR_DELAI TINYINT(4),
        OUT _CDE_STATUS TINYINT(4),
        OUT _DELAI_CDE_STATUS TINYINT(4)
    )
BEGIN

SELECT IF (COUNT(*)>0,`t_panne`.`StatutPanne`,0) AS CDE_STATUS INTO _CDE_STATUS
FROM `t_panne`
WHERE 
`t_panne`.`StatutPanne`>2 AND
`t_panne`.`NumPanne` = _NUM_TICKET_PANNE;

SELECT `f_check_delai_prise_cde`(_NB_JOUR_DELAI,_NUM_TICKET_PANNE) into _DELAI_CDE_STATUS;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_INIT_PROFILE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `P_INIT_PROFILE`(
        IN _NUMAPPEL VARCHAR(12),
        IN _INIT_CODE INTEGER(10),
        OUT _INIT_RESULT TINYINT(2)
    )
BEGIN

	DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;
	DECLARE EXIT HANDLER FOR SQLWARNING ROLLBACK;	
	START TRANSACTION;	

	SET _INIT_RESULT = 0;

	IF (`f_checkProfileInit`(_NUMAPPEL,_INIT_CODE)=0) THEN
    
	INSERT INTO `t_numeroappel` (NumAppel,IDProfile)VALUES(_NUMAPPEL,SUBSTR(_INIT_CODE,1,1));
    
    IF(SUBSTR(_INIT_CODE,1,1)=1) THEN
    
    	UPDATE `t_comite` SET `t_comite`.`IDNumAppel`=`f_getIDNumappelByNumAppel`(_NUMAPPEL),`t_comite`.`InitSatus`=1 WHERE `t_comite`.`CodeInitComite`=_INIT_CODE;
        
        CALL P_INSERT_APPELTELEPHONIQUE(0,0,f_getIDNumappelByNumAppel(_NUMAPPEL));
        
    	SET _INIT_RESULT = 1;
        
    END IF;  
    
    IF(SUBSTR(_INIT_CODE,1,1)=2) THEN
    
    	UPDATE `t_reparateur` SET `t_reparateur`.`IDNumAppel`=`f_getIDNumappelByNumAppel`(_NUMAPPEL),`t_reparateur`.`InitSatus`=1 WHERE `t_reparateur`.`CodeInitRep`=_INIT_CODE;
        
        CALL P_INSERT_APPELTELEPHONIQUE(0,0,f_getIDNumappelByNumAppel(_NUMAPPEL));
        
    	SET _INIT_RESULT = 1;
    END IF; 
    
    IF(SUBSTR(_INIT_CODE,1,1)>=3) THEN
    
    	UPDATE `t_agent` SET `t_agent`.`IDNumAppel`=`f_getIDNumappelByNumAppel`(_NUMAPPEL),`t_agent`.`IDNumAppelNotification`=`f_getIDNumappelByNumAppel`(_NUMAPPEL),`t_agent`.`InitSatus`=1 WHERE `t_agent`.`CodeInitAgent`=_INIT_CODE;
        
        CALL P_INSERT_APPELTELEPHONIQUE(0,0,f_getIDNumappelByNumAppel(_NUMAPPEL));
        
    	SET _INIT_RESULT = 1;
        
    END IF; 
    
    ELSEIF (`f_getIDNumappelByNumAppel`(_NUMAPPEL)>0) THEN
    
    SET _INIT_RESULT = 0;
    
    END IF;
    
    COMMIT;
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_INSERT_APPELTELEPHONIQUE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_INSERT_APPELTELEPHONIQUE`(
        IN _MOTIFAPPEL TINYINT(2),
        IN _IDPANNE INTEGER(4),
        IN _IDNUMAPPEL INTEGER(4)
    )
BEGIN

	INSERT INTO `t_appeltelephonique` (DateHeureAppel,MotifAppel,IDPanne,IDNumAppel)VALUES(NOW(),_MOTIFAPPEL,_IDPANNE,_IDNUMAPPEL);  
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_INSERT_PANNE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_INSERT_PANNE`(
        IN _STATUTPANNE TINYINT(2),
        IN _CODEOUVRAGE INTEGER(4),
        IN _IDCOMITE INTEGER(4),
        OUT _IDPANNE INTEGER(4)
    )
BEGIN
	IF(f_checkIDOuvrage(_CODEOUVRAGE)>0) THEN
		INSERT INTO `t_panne` (NumPanne,DateApparution,StatutPanne,IDComite,IDOuvrage)VALUES(`f_generateTicket`(),NOW(),_STATUTPANNE,_IDCOMITE,f_checkIDOuvrage(_CODEOUVRAGE));
        SET _IDPANNE=LAST_INSERT_ID();
        COMMIT;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_INSERT_PANNE2` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_INSERT_PANNE2`(
        IN _STATUTPANNE TINYINT(2),
        IN _CODEOUVRAGE INTEGER(4),
        OUT _IDPANNE INTEGER(4)
    )
BEGIN
	IF(f_checkIDOuvrage(_CODEOUVRAGE)>0) THEN
		INSERT INTO `t_panne` (NumPanne,DateApparution,StatutPanne,IDOuvrage)VALUES(`f_generateTicket`(),NOW(),_STATUTPANNE,f_checkIDOuvrage(_CODEOUVRAGE));
        SET _IDPANNE=LAST_INSERT_ID();
        COMMIT;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_NEW_PANNE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_NEW_PANNE`(
        IN _NUMAPPEL VARCHAR(12),
        IN _CODEOUVRAGE VARCHAR(5),
        IN _STATUTPANNE TINYINT(4),
        IN _STATUTOUVRAGE INTEGER(2),
        IN _MOTIFAPPEL TINYINT(2),
        OUT _UPDATE_RESULT VARCHAR(5)
    )
    DETERMINISTIC
BEGIN

DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;
DECLARE EXIT HANDLER FOR SQLWARNING ROLLBACK;	
START TRANSACTION;

CALL `P_INSERT_PANNE`(_STATUTPANNE,_CODEOUVRAGE,f_getIDComiteByIDNumAppel(f_getIDNumappelByNumAppel(_NUMAPPEL)),@_IDPANNE);
CALL `P_INSERT_APPELTELEPHONIQUE`(_MOTIFAPPEL,@_IDPANNE,f_getIDNumappelByNumAppel(_NUMAPPEL));
CALL `P_UPDATE_OUVRAGE_STATUS_BY_IDCOMITE`(_STATUTOUVRAGE,f_getIDComiteByIDNumAppel(f_getIDNumappelByNumAppel(_NUMAPPEL)));

COMMIT;

SET _UPDATE_RESULT=f_getPanneTicketByPanneId(@_IDPANNE);

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_SELECT_INFOS_AGENT_BY_PHONE_AGENT` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_SELECT_INFOS_AGENT_BY_PHONE_AGENT`(
        IN _PHONE_AGENT VARCHAR(12),
        OUT _NOMAGENT VARCHAR(100)
    )
BEGIN

 SELECT CONCAT(`t_agent`.`NomAgent`,' ',`t_agent`.`PrenomsAgent`) AS NOMREP INTO _NOMAGENT
    FROM `t_agent`
    WHERE 
    `t_agent`.`IDAgent`= `f_getIDAgentByIDNumAppel`(f_getIDNumappelByNumAppel(_PHONE_AGENT));

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_SELECT_INFOS_OUVRAGE_BY_NUMAPPEL_COMITE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_SELECT_INFOS_OUVRAGE_BY_NUMAPPEL_COMITE`(
        IN _NUMAPPEL VARCHAR(12),
        OUT _CODEOUVRAGE VARCHAR(10),
        OUT _IDREGION INTEGER(10),
        OUT _NOMLOCALITE VARCHAR(50),
        OUT _NOMCOMITE VARCHAR(100),
        OUT _NUMAPPEL_REP VARCHAR(12),
        OUT _NUMAGENT_FORMA VARCHAR(12),
        OUT _NUMAGENT_SOCIOLOGUE VARCHAR(12),
        OUT _NUM_DR VARCHAR(12),
        OUT _NOMREP VARCHAR(100),
        OUT _NOMAGENT_FORMA VARCHAR(100),
        OUT _NOMAGENT_SOCIOLOGUE VARCHAR(100),
        OUT _NOM_DR VARCHAR(100),
        OUT _STATUTOUVRAGE TINYINT(2)
    )
    DETERMINISTIC
    SQL SECURITY INVOKER
BEGIN

DECLARE IDREGION INTEGER(10);
DECLARE IDLOCALITE INTEGER(10);
DECLARE IDREPARATEUR INTEGER(10);
-- DECLARE IDAGENT INTEGER(4);
DECLARE IDAGENT_FORMA INTEGER(10);
DECLARE IDSOCIOLOGUE INTEGER(10);
DECLARE IDDR INTEGER(10);

	SELECT `t_ouvrage`.`CodeOuvrage`,`t_ouvrage`.`Statut`,`t_ouvrage`.`IDLocalite`
    INTO _CODEOUVRAGE,_STATUTOUVRAGE,IDLOCALITE
    FROM `t_ouvrage`
    WHERE `t_ouvrage`.`IDComite`=`f_getIDComiteByIDNumAppel`(f_getIDNumappelByNumAppel(_NUMAPPEL));
    
    SELECT `t_localite`.`IDAgentForma`,`t_localite`.`IDReparateur` INTO IDAGENT_FORMA,IDREPARATEUR
    FROM `t_localite`
    WHERE `t_localite`.`IDLocalite`=IDLOCALITE;
    
    SELECT `t_comite`.`NomComite`
    INTO _NOMCOMITE
    FROM `t_comite`
    WHERE 
    `t_comite`.`IDComite`=`f_getIDComiteByIDNumAppel`(f_getIDNumappelByNumAppel(_NUMAPPEL));
    
    SELECT CONCAT(`t_reparateur`.`NomRep`,' ',`t_reparateur`.`PrenomsRep`) AS NOMREP ,`t_numeroappel`.`NumAppel` 
    INTO _NOMREP,_NUMAPPEL_REP
    FROM `t_reparateur`,`t_numeroappel`
    WHERE 
    `t_reparateur`.`IDNumAppel` = `t_numeroappel`.`IDNumAppel` AND
    `t_reparateur`.`IDReparateur` = IDREPARATEUR;
    
    SELECT `t_region`.`IDRegion`, CONCAT(`t_region`.`NomRegion`,'/',`t_localite`.`NomLocalite`) AS NOMLOCALITE INTO _IDREGION,_NOMLOCALITE
    FROM `t_region`,`t_localite`
    WHERE 
    `t_region`.`IDRegion`=`t_localite`.`IDRegion`
    AND `t_localite`.`IDLocalite`=IDLOCALITE
    ;
    
    SELECT CONCAT(`t_agent`.`NomAgent`,' ',`t_agent`.`PrenomsAgent`)AS NOMAGENT_FORMA, `t_numeroappel`.`NumAppel` INTO _NOMAGENT_FORMA,_NUMAGENT_FORMA
    FROM `t_agent`,t_numeroappel 
    WHERE 
    `t_agent`.`IDNumAppelNotification`=`t_numeroappel`.`IDNumAppel`
    AND `t_agent`.`IDAgent`=IDAGENT_FORMA;
    /*
    SELECT CONCAT(`t_agent`.`NomAgent`,' ',`t_agent`.`PrenomsAgent`)AS NOMAGENT_SOCIOLOGUE, `t_numeroappel`.`NumAppel` INTO _NOMAGENT_SOCIOLOGUE,_NUMAGENT_SOCIOLOGUE
    FROM `t_agent`,t_numeroappel 
    WHERE t_numeroappel.`IDNumAppel`=`t_agent`.`IDNumAppel`
    AND `t_agent`.`IDAgent`=IDSOCIOLOGUE;
    
    SELECT CONCAT(`t_agent`.`NomAgent`,' ',`t_agent`.`PrenomsAgent`)AS NOM_DR, `t_numeroappel`.`NumAppel` INTO _NOM_DR,_NUM_DR
    FROM `t_agent`,t_numeroappel 
    WHERE t_numeroappel.`IDNumAppel`=`t_agent`.`IDNumAppel`
    AND `t_agent`.`IDAgent`=IDDR;*/
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_SELECT_INFOS_OUVRAGE_BY_NUMPANNE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_SELECT_INFOS_OUVRAGE_BY_NUMPANNE`(
        IN _NUMPANNE VARCHAR(12),
        OUT _CODEOUVRAGE VARCHAR(5),
        OUT _IDREGION INTEGER(10),
        OUT _NOMLOCALITE VARCHAR(50),
        OUT _NUMAPPEL_REP VARCHAR(12),
        OUT _NUMAGENT_FORMA VARCHAR(12),
        OUT _NUM_SOCIOLOGUE VARCHAR(20),
        OUT _NUM_COMITE VARCHAR(12),
        OUT _NOMREP VARCHAR(100),
        OUT _NOMAGENT_FORMA VARCHAR(100),
        OUT _NOM_SOCIOLOGUE VARCHAR(100),
        OUT _STATUTOUVRAGE VARCHAR(5)
    )
BEGIN

DECLARE IDLOCALITE INTEGER(4);
DECLARE IDCOMITE INTEGER(10);
DECLARE IDREPARATEUR INTEGER(4);
DECLARE IDAGENT_FORMA INTEGER(4);
DECLARE IDSOCIOLOGUE INTEGER(4);
DECLARE IDDR INTEGER(4);

	SELECT `t_ouvrage`.`CodeOuvrage`,`t_ouvrage`.`StatutOuvrage`,`t_ouvrage`.`IDLocalite`,`t_ouvrage`.`IDComite`
    INTO _CODEOUVRAGE,_STATUTOUVRAGE,IDLOCALITE,IDCOMITE
    FROM `t_ouvrage`
    WHERE 
    `t_ouvrage`.`IDOuvrage`=`f_getIDOuvrageByNumPanne`(_NUMPANNE);
    
    SELECT `t_localite`.`IDReparateur`,`t_localite`.`IDAgentForma` INTO IDREPARATEUR,IDAGENT_FORMA
    FROM `t_localite`
    WHERE `t_localite`.`IDLocalite`=IDLOCALITE;
    
    SELECT f_getNumAppelByIDNumAppel(`t_comite`.`IDNumAppel`) INTO _NUM_COMITE
    FROM `t_comite`
    WHERE `t_comite`.`IDComite`=IDCOMITE;
    
    SELECT CONCAT(`t_reparateur`.`NomRep`,' ',`t_reparateur`.`PrenomsRep`) AS NOMREP ,`t_numeroappel`.`NumAppel` INTO _NOMREP,_NUMAPPEL_REP
    FROM `t_reparateur`,`t_numeroappel` 
    WHERE 
    `t_reparateur`.`IDReparateur`=IDREPARATEUR
    AND `t_reparateur`.`IDNumAppel`=`t_numeroappel`.`IDNumAppel`;
    
    SELECT `t_region`.`IDRegion`, CONCAT(`t_region`.`NomRegion`,'/',`t_localite`.`NomLocalite`) AS NOMLOCALITE,`t_localite`.`IDReparateur`,`t_localite`.`IDAgentForma`,`t_region`.`IDSociologue`,`t_region`.`IDDR` INTO _IDREGION,_NOMLOCALITE,IDREPARATEUR,IDAGENT_FORMA,IDSOCIOLOGUE,IDDR 
    FROM `t_region`,`t_localite`,`t_ouvrage`
    WHERE 
    `t_region`.`IDRegion`=`t_localite`.`IDRegion` AND
    `t_ouvrage`.`IDOuvrage`=`f_getIDOuvrageByNumPanne`(_NUMPANNE) AND
    `t_localite`.`IDLocalite`=`t_ouvrage`.`IDLocalite` AND
    `t_localite`.`IDLocalite`=IDLOCALITE;
    
    SELECT CONCAT(`t_agent`.`NomAgent`,' ',`t_agent`.`PrenomsAgent`)AS NOMAGENT_FORMA, `t_numeroappel`.`NumAppel` INTO _NOMAGENT_FORMA,_NUMAGENT_FORMA
    FROM `t_agent`,t_numeroappel
    WHERE
    t_numeroappel.`IDNumAppel`=`t_agent`.`IDNumAppelNotification`
    AND `t_agent`.`IDAgent`=IDAGENT_FORMA;
    
    SELECT CONCAT(`t_agent`.`NomAgent`,' ',`t_agent`.`PrenomsAgent`)AS NOMAGENT_SOCIOLOGUE, `t_numeroappel`.`NumAppel` 
    INTO _NOM_SOCIOLOGUE,_NUM_SOCIOLOGUE
    FROM `t_agent`,t_numeroappel 
    WHERE t_numeroappel.`IDNumAppel`=`t_agent`.`IDNumAppel`
    AND `t_agent`.`IDAgent`=IDSOCIOLOGUE;
    /*
    SELECT CONCAT(`t_agent`.`NomAgent`,' ',`t_agent`.`PrenomsAgent`)AS NOM_DR, `t_numeroappel`.`NumAppel` INTO _NOM_DR,_NUM_DR
    FROM `t_agent`,t_numeroappel 
    WHERE t_numeroappel.`IDNumAppel`=`t_agent`.`IDNumAppel`
    AND `t_agent`.`IDAgent`=IDDR;*/
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_SELECT_INFOS_REPARATEUR_BY_PHONE_REP` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_SELECT_INFOS_REPARATEUR_BY_PHONE_REP`(
        IN _PHONE_REP VARCHAR(12),
        OUT _NOMREP VARCHAR(100)
    )
    DETERMINISTIC
    SQL SECURITY INVOKER
BEGIN

 SELECT CONCAT(`t_reparateur`.`NomRep`,' ',`t_reparateur`.`PrenomsRep`) AS NOMREP INTO _NOMREP
    FROM `t_reparateur`
    WHERE 
    `t_reparateur`.`IDReparateur`= f_getIDReparateurByIDNumAppel(f_getIDNumappelByNumAppel(_PHONE_REP));

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_UPDATE_AGENT_IDNUMAPPEL_NOTIFICATION_BY_NUMAPPEL` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_UPDATE_AGENT_IDNUMAPPEL_NOTIFICATION_BY_NUMAPPEL`(
        IN _NUMAPPEL_TOBE_REPLACE VARCHAR(20),
        IN _NUMAPPEL_WITCH_REPLACE VARCHAR(20),
        OUT _UPDATE_RESULT TINYINT(2)
    )
BEGIN
		DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;
		DECLARE EXIT HANDLER FOR SQLWARNING ROLLBACK;	
		START TRANSACTION;	
    
    	/*UPDATE `t_ouvrage` 
        SET `t_ouvrage`.`IDAgentFormaBack`=`t_ouvrage`.`IDAgentForma`,`t_ouvrage`.`IDAgentForma`=f_getIDAgentByIDNumAppel(f_getIDNumappelByNumAppel(_NUMAPPEL_WITCH_REPLACE))
        WHERE `t_ouvrage`.`IDAgentForma`=f_getIDAgentByIDNumAppel(f_getIDNumappelByNumAppel(_NUMAPPEL_TOBE_REPLACE));*/
        
        UPDATE `t_agent` 
        SET `t_agent`.`IDNumAppelNotification`=f_getIDNumappelByNumAppel(_NUMAPPEL_WITCH_REPLACE),`t_agent`.`InitSatus`=2
        WHERE `t_agent`.`IDAgent`=f_getIDAgentByIDNumAppel(f_getIDNumappelByNumAppel(_NUMAPPEL_TOBE_REPLACE));
        
        CALL `P_INSERT_APPELTELEPHONIQUE`(5,0,f_getIDNumappelByNumAppel(_NUMAPPEL_TOBE_REPLACE));
        
        SET _UPDATE_RESULT=1;
        
        COMMIT;
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_UPDATE_OUVRAGE_STATUS_BY_IDAGENT` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_UPDATE_OUVRAGE_STATUS_BY_IDAGENT`(
        IN _OUVRAGE_STATUS TINYINT(4),
        IN _IDAGENT INTEGER(4)
    )
BEGIN

SET @requete = 'UPDATE `t_ouvrage` SET ';

SET @requete = CONCAT(@requete,'t_ouvrage.`StatutOuvrage`=',_OUVRAGE_STATUS,' WHERE `t_ouvrage`.`IDAgent`=',_IDAGENT);

PREPARE stmt1 FROM @requete;  
EXECUTE stmt1 ;  
DEALLOCATE PREPARE stmt1;

COMMIT;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_UPDATE_OUVRAGE_STATUS_BY_IDCOMITE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_UPDATE_OUVRAGE_STATUS_BY_IDCOMITE`(
        IN _OUVRAGE_STATUS TINYINT(4),
        IN _IDCOMITE INTEGER(4)
    )
BEGIN

SET @requete = 'UPDATE `t_ouvrage` SET ';

SET @requete = CONCAT(@requete,'`t_ouvrage`.`StatutOuvrage`=IF((',_OUVRAGE_STATUS,'>1),"PANNE","MARCHE"),`t_ouvrage`.`Statut`=',_OUVRAGE_STATUS,',`t_ouvrage`.`StatutPanne`=',_OUVRAGE_STATUS,' WHERE `t_ouvrage`.`IDComite`=',_IDCOMITE);

PREPARE stmt1 FROM @requete;  
EXECUTE stmt1 ;  
DEALLOCATE PREPARE stmt1;

COMMIT;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_UPDATE_OUVRAGE_STATUS_BY_IDREPARATEUR` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_UPDATE_OUVRAGE_STATUS_BY_IDREPARATEUR`(
        IN _OUVRAGE_STATUS TINYINT(4),
        IN _IDREPARATEUR INTEGER(4)
    )
BEGIN

SET @requete = 'UPDATE `t_ouvrage` SET ';

SET @requete = CONCAT(@requete,'t_ouvrage.`StatutOuvrage`=',_OUVRAGE_STATUS,' WHERE `t_ouvrage`.`IDReparateur`=',_IDREPARATEUR);

PREPARE stmt1 FROM @requete;  
EXECUTE stmt1 ;  
DEALLOCATE PREPARE stmt1;

COMMIT;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_UPDATE_PANNE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `P_UPDATE_PANNE`(
        IN _NUMPANNE VARCHAR(5),
        IN _DATEPRISECHARGE DATETIME,
        IN _DATEDEBUTREP DATETIME,
        IN _DATEREPARATION DATETIME,
        IN _STATUTPANNE VARCHAR(10),
        OUT _UPDATE_RESULT TINYINT(2)
    )
BEGIN

-- DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;
-- DECLARE EXIT HANDLER FOR SQLWARNING ROLLBACK;	
-- START TRANSACTION;	

SET @requete = 'UPDATE `t_panne` SET ';

IF (_DATEPRISECHARGE<>'0000-00-00 00:00:00') THEN	
	SET @requete = CONCAT(@requete,"`t_panne`.`DatePriseCharge`='",_DATEPRISECHARGE,"',");
END IF;

IF _DATEDEBUTREP<>'0000-00-00 00:00:00' THEN	
	SET @requete = CONCAT(@requete,"`t_panne`.`DateDebutRep`='",_DATEDEBUTREP,"',");
END IF;

IF _DATEREPARATION<>'0000-00-00 00:00:00' THEN	
	SET @requete = CONCAT(@requete,"`t_panne`.`DateReparation`='",_DATEREPARATION,"',");
END IF;

IF _STATUTPANNE<>'' THEN	
    SET @requete = CONCAT(@requete,"`t_panne`.`StatutPanne`='",_STATUTPANNE,"'");
END IF;

SET @requete = CONCAT(@requete," WHERE `t_panne`.`NumPanne`='",_NUMPANNE,"'");

SET @requete2 = CONCAT(' UPDATE `t_ouvrage` SET `t_ouvrage`.`DateMiseAjour`=NOW(), `t_ouvrage`.`StatutOuvrage`=IF((',_STATUTPANNE,' > '"1"'),"PANNE","MARCHE"),`t_ouvrage`.`Statut`="',_STATUTPANNE,',`t_ouvrage`.`StatutPanne`="',_STATUTPANNE,'" WHERE `t_ouvrage`.`IDOuvrage`=`f_getIDOuvrageByNumPanne`(',_NUMPANNE,')');

-- SET @requete2 = CONCAT(" UPDATE `t_ouvrage` SET `t_ouvrage`.`DateMiseAjour`=NOW(), `t_ouvrage`.`Statut`='",_STATUTPANNE,"' WHERE `t_ouvrage`.`IDOuvrage`=`f_getIDOuvrageByNumPanne`(",_NUMPANNE,")");

PREPARE stmt1 FROM @requete;
EXECUTE stmt1 ;
DEALLOCATE PREPARE stmt1;

PREPARE stmt1 FROM @requete2;
EXECUTE stmt1 ;  
DEALLOCATE PREPARE stmt1;

COMMIT; 
   
SET _UPDATE_RESULT=1;



END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_UPDATE_PANNE_BY_CODE_PROFILE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `P_UPDATE_PANNE_BY_CODE_PROFILE`(
        IN _NUMPANNE VARCHAR(5),
        IN _CODE_PROFILE TINYINT(4),
        IN _STATUTPANNE TINYINT(2),
        OUT _UPDATE_RESULT TINYINT(2)
    )
BEGIN

-- DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;
-- DECLARE EXIT HANDLER FOR SQLWARNING ROLLBACK;	
-- START TRANSACTION;	

SET @requete = 'UPDATE `t_panne` SET ';

IF (_DATEPRISECHARGE<>'0000-00-00 00:00:00') THEN	
	SET @requete = CONCAT(@requete,"`t_panne`.`DatePriseCharge`='",_DATEPRISECHARGE,"',");
END IF;

IF _DATEDEBUTREP<>'0000-00-00 00:00:00' THEN	
	SET @requete = CONCAT(@requete,"`t_panne`.`DateDebutRep`='",_DATEDEBUTREP,"',");
END IF;

IF _DATEREPARATION<>'0000-00-00 00:00:00' THEN	
	SET @requete = CONCAT(@requete,"`t_panne`.`DateReparation`='",_DATEREPARATION,"',");
END IF;

IF _STATUTPANNE<>'' THEN	
    SET @requete = CONCAT(@requete,"`t_panne`.`StatutPanne`='",_STATUTPANNE,"'");
END IF;

SET @requete = CONCAT(@requete," WHERE `t_panne`.`NumPanne`='",_NUMPANNE,"'");

SET @requete2 = CONCAT(' UPDATE `t_ouvrage` SET `t_ouvrage`.`DateMiseAjour`=NOW(), `t_ouvrage`.`StatutOuvrage`=IF((',_STATUTPANNE,' > '"1"'),"PANNE","MARCHE"),`t_ouvrage`.`Statut`="',_STATUTPANNE,'" WHERE `t_ouvrage`.`IDOuvrage`=`f_getIDOuvrageByNumPanne`(',_NUMPANNE,')');

-- SET @requete2 = CONCAT(" UPDATE `t_ouvrage` SET `t_ouvrage`.`DateMiseAjour`=NOW(), `t_ouvrage`.`Statut`='",_STATUTPANNE,"' WHERE `t_ouvrage`.`IDOuvrage`=`f_getIDOuvrageByNumPanne`(",_NUMPANNE,")");

PREPARE stmt1 FROM @requete;
EXECUTE stmt1 ;
DEALLOCATE PREPARE stmt1;

PREPARE stmt1 FROM @requete2;
EXECUTE stmt1 ;  
DEALLOCATE PREPARE stmt1;

COMMIT; 
   
SET _UPDATE_RESULT=1;



END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_UPDATE_PANNE_BY_NUM_COMITE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_UPDATE_PANNE_BY_NUM_COMITE`(
        IN _NUMCOMITE VARCHAR(12),
        IN _STATUTPANNE TINYINT(4),
        OUT _UPDATE_RESULT TINYINT(2)
    )
    DETERMINISTIC
BEGIN

DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;
DECLARE EXIT HANDLER FOR SQLWARNING ROLLBACK;	
START TRANSACTION;	

SET @requete = 'UPDATE `t_panne` SET `t_panne`.`DateReparation`=NOW()';

SET @requete = CONCAT(@requete,',`t_panne`.`StatutPanne`=',_STATUTPANNE,' WHERE `t_panne`.`IDOuvrage`=`f_getIDOuvrageByNumAppel`(',_NUMCOMITE,')');

SET @requete2 = 'UPDATE `t_ouvrage` SET ';

SET @requete2 = CONCAT(@requete2,'`t_ouvrage`.`StatutOuvrage`=IF((',_STATUTPANNE,'>1),"PANNE","MARCHE"),`t_ouvrage`.`Statut`=',_STATUTPANNE,',`t_ouvrage`.`StatutPanne`=',_STATUTPANNE,',`t_ouvrage`.`dateStatut`=NOW() WHERE `t_ouvrage`.`IDOuvrage`=`f_getIDOuvrageByNumAppel`(',_NUMCOMITE,')');

PREPARE stmt1 FROM @requete;
PREPARE stmt2 FROM @requete2;
EXECUTE stmt1 ;
EXECUTE stmt2 ;  
DEALLOCATE PREPARE stmt1;
DEALLOCATE PREPARE stmt2;

/*UPDATE `t_ouvrage` SET `t_ouvrage`.`StatutOuvrage`=_STATUTPANNE 
    WHERE `t_ouvrage`.`IDOuvrage`=f_getIDOuvrageByNumAppel(_NUMCOMITE);*/

CALL `P_INSERT_APPELTELEPHONIQUE`(2,f_getIDPanneByIDOuvrage(`f_getIDOuvrageByNumAppel`(_NUMCOMITE)),f_getIDNumappelByNumAppel(_NUMCOMITE));
       
SET _UPDATE_RESULT=1;

COMMIT;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_UPDATE_PANNE_NEW` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `P_UPDATE_PANNE_NEW`(
        IN _NUMAPPEL VARCHAR(20),
        IN _NUMPANNE VARCHAR(5),
        IN _UP_TYPE VARCHAR(20),
        IN _UP_STATUS TINYINT(2),
        IN _STATUTPANNE TINYINT(2),
        OUT _UPDATE_RESULT TINYINT(2)
    )
BEGIN

DECLARE STATUTPANNE VARCHAR(10);
DECLARE MOTIFAPPEL TINYINT(2);

DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;
DECLARE EXIT HANDLER FOR SQLWARNING ROLLBACK;	
START TRANSACTION;	

SET STATUTPANNE=(IF(_STATUTPANNE>1,"PANNE","MARCHE"));

IF (_UP_TYPE<>'') THEN

	SET @requete2 = CONCAT('UPDATE `t_ouvrage` SET ');
	
	SET @requete = 'UPDATE `t_panne` SET ';

	IF (_UP_TYPE='PANNE_PRISE_CHARGE') THEN	
    	SET MOTIFAPPEL=4;
		SET @requete = CONCAT(@requete,"`t_panne`.`DatePriseCharge`=NOW(),");
	END IF;

	IF _UP_TYPE='DEBUT_REP_PANNE' THEN
    	SET MOTIFAPPEL=3;	
		SET @requete = CONCAT(@requete,"`t_panne`.`DateDebutRep`=NOW(),");
	END IF;

	IF _UP_TYPE='PANNE_REPARER' THEN
    	SET MOTIFAPPEL=5;	
		SET @requete = CONCAT(@requete,"`t_panne`.`DateReparation`=NOW(),");
	END IF;

	IF _STATUTPANNE<>'' THEN
		-- SET @requete = CONCAT(@requete,"`t_panne`.`StatutPanne`='",_STATUTPANNE,"'");
		SET @requete = CONCAT(@requete,"`t_panne`.`StatutPanne`='",_STATUTPANNE,"',");
	END IF;
    
    IF (_UP_STATUS=1) THEN    
        SET @requete2 = CONCAT(@requete2,'`t_ouvrage`.`StatutOuvrage`=IF((',_STATUTPANNE,'>1),"PANNE","MARCHE"),`t_ouvrage`.`Statut`=',_STATUTPANNE,',`t_ouvrage`.`StatutPanne`=',_STATUTPANNE,',');
	END IF;
    
    SET @requete=LEFT(@requete,LENGTH(@requete)-1);

	SET @requete = CONCAT(@requete," WHERE `t_panne`.`NumPanne`='",_NUMPANNE,"'");

	SET @requete2 = CONCAT(@requete2,'`t_ouvrage`.`DateMiseAjour`=NOW() WHERE `t_ouvrage`.`IDOuvrage`=`f_getIDOuvrageByNumPanne`(',_NUMPANNE,')');

	PREPARE stmt2 FROM @requete2;
	EXECUTE stmt2 ;  
    DEALLOCATE PREPARE stmt2;

	PREPARE stmt1 FROM @requete;
	EXECUTE stmt1 ;
	DEALLOCATE PREPARE stmt1;
    
    CALL `P_INSERT_APPELTELEPHONIQUE`(MOTIFAPPEL,f_getPanneIdByPanneTicket(_NUMPANNE),f_getIDNumappelByNumAppel(_NUMAPPEL));
    
    SET _UPDATE_RESULT=1;
 	
ELSE

	SET _UPDATE_RESULT=0;
    
END IF;
	
	COMMIT; 
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_UPDATE_PANNE_PRISE_CHARGE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `P_UPDATE_PANNE_PRISE_CHARGE`(
        IN _NUMPANNE VARCHAR(5),
        IN _STATUTPANNE TINYINT(2),
        OUT _UPDATE_RESULT TINYINT(2)
    )
    DETERMINISTIC
BEGIN

-- DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;
-- DECLARE EXIT HANDLER FOR SQLWARNING ROLLBACK;	
-- START TRANSACTION;	

UPDATE `t_panne` SET `t_panne`.`DatePriseCharge`=NOW(),`t_panne`.`StatutPanne`=_STATUTPANNE WHERE `t_panne`.`NumPanne`=_NUMPANNE;

-- UPDATE `t_ouvrage` SET `t_ouvrage`.`DateMiseAjour`=NOW(), `t_ouvrage`.`StatutOuvrage`=(SELECT IF(_STATUTPANNE > 1,'PANNE','MARCHE')),`t_ouvrage`.`Statut`=_STATUTPANNE WHERE `t_ouvrage`.`IDOuvrage`=`f_getIDOuvrageByNumPanne`(_NUMPANNE);

SET _UPDATE_RESULT=1;

-- COMMIT;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_UPDATE_RESTORE_IDAGENTFORMA_BY_NUMAPPEL` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_UPDATE_RESTORE_IDAGENTFORMA_BY_NUMAPPEL`(
        IN _NUMAPPEL VARCHAR(20),
        OUT _UPDATE_RESULT TINYINT(2)
    )
BEGIN
	DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;
	DECLARE EXIT HANDLER FOR SQLWARNING ROLLBACK;	
	START TRANSACTION;
    
    /*UPDATE `t_ouvrage` 
    SET `t_ouvrage`.`IDAgentForma`=if(`t_ouvrage`.`IDAgentFormaBack`>0,`t_ouvrage`.`IDAgentFormaBack`,`t_ouvrage`.`IDAgentForma`) ,`t_ouvrage`.`IDAgentFormaBack`=0
    WHERE `t_ouvrage`.`IDAgentFormaBack`=f_getIDAgentBackByIDNumAppel(f_getIDNumappelByNumAppel(_NUMAPPEL));*/
        
    UPDATE `t_agent` 
    SET `t_agent`.`IDNumAppelNotification`=IF(`t_agent`.`InitSatus`=2,`t_agent`.`IDNumAppel`,`t_agent`.`IDNumAppelNotification`),`t_agent`.`InitSatus`=1
    WHERE `t_agent`.`IDAgent`=`f_getIDAgentByIDNumAppel`(f_getIDNumappelByNumAppel(_NUMAPPEL));
    
	CALL `P_INSERT_APPELTELEPHONIQUE`(6,0,f_getIDNumappelByNumAppel(_NUMAPPEL));
    
    SET _UPDATE_RESULT=1;
    
    COMMIT;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_VERIF_INIT_CODE` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_VERIF_INIT_CODE`(
        IN _CODE_INIT VARCHAR(10),
        IN _CODE_PROFIL TINYINT(2),
        OUT _INIT_STATUS TINYINT(2),
        OUT _CODE_VALIDITY TINYINT(2)
    )
BEGIN
	IF _CODE_PROFIL=1 THEN
    
    	SELECT IF(COUNT(*)>0,1,0) INTO _CODE_VALIDITY
        FROM `t_comite`
        WHERE `t_comite`.`CodeInitComite`=_CODE_INIT;	
    
		SELECT IF(COUNT(*)>0,1,0) INTO _INIT_STATUS
        FROM `t_comite`
        WHERE `t_comite`.`CodeInitComite`=_CODE_INIT 
        AND
        `t_comite`.`InitSatus`>0; 
    END IF;
    
    IF _CODE_PROFIL=2 THEN
    
    	SELECT IF(COUNT(*)>0,1,0) INTO _CODE_VALIDITY
        FROM `t_reparateur`
        WHERE `t_reparateur`.`CodeInitRep`=_CODE_INIT;
    
    	SELECT IF(COUNT(*)>0,1,0) INTO _INIT_STATUS
        FROM `t_reparateur`
        WHERE `t_reparateur`.`CodeInitRep`=_CODE_INIT 
        AND
        `t_reparateur`.`InitSatus`>0;
    END IF;
    
    IF _CODE_PROFIL>2 THEN
    
    	SELECT IF(COUNT(*)>0,1,0) INTO _CODE_VALIDITY
        FROM `t_agent`
        WHERE `t_agent`.`CodeInitAgent`=_CODE_INIT;
    
    	SELECT IF(COUNT(*)>0,1,0) INTO _INIT_STATUS
        FROM `t_agent`
        WHERE `t_agent`.`CodeInitAgent`=_CODE_INIT 
        AND
        `t_agent`.`InitSatus`>0;
    END IF;
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `P_VERIF_NUM_INTERIM` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = latin1 */ ;
/*!50003 SET character_set_results = latin1 */ ;
/*!50003 SET collation_connection  = latin1_swedish_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = '' */ ;
DELIMITER ;;
CREATE DEFINER=`susie`@`%` PROCEDURE `P_VERIF_NUM_INTERIM`(
        IN _NUM_AGENT VARCHAR(20),
        IN _NUM_INTERIM VARCHAR(20),
        OUT _RESULT_STATUS TINYINT(2)
    )
BEGIN

	SELECT IF(COUNT(*)>0,1,0)  INTO _RESULT_STATUS
    FROM `t_agent`
    WHERE `t_agent`.`IDRegion`=(
    							SELECT `t_agent`.`IDRegion`
    							FROM `t_agent`
    							WHERE `t_agent`.`IDAgent`=f_getIDAgentByIDNumAppel(f_getIDNumappelByNumAppel(_NUM_INTERIM))
    )
    AND
    `t_agent`.`IDAgent`=f_getIDAgentByIDNumAppel(f_getIDNumappelByNumAppel(_NUM_AGENT));
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;

--
-- Current Database: `db_sofie`
--

USE `db_sofie`;

--
-- Final view structure for view `v_forage_hors_delai_prise_charge`
--

/*!50001 DROP TABLE IF EXISTS `v_forage_hors_delai_prise_charge`*/;
/*!50001 DROP VIEW IF EXISTS `v_forage_hors_delai_prise_charge`*/;
/*!50001 SET @saved_cs_client          = @@character_set_client */;
/*!50001 SET @saved_cs_results         = @@character_set_results */;
/*!50001 SET @saved_col_connection     = @@collation_connection */;
/*!50001 SET character_set_client      = latin1 */;
/*!50001 SET character_set_results     = latin1 */;
/*!50001 SET collation_connection      = latin1_swedish_ci */;
/*!50001 CREATE ALGORITHM=UNDEFINED */
/*!50013 DEFINER=`root`@`%` SQL SECURITY DEFINER */
/*!50001 VIEW `v_forage_hors_delai_prise_charge` AS select `t_ouvrage`.`CodeOuvrage` AS `CODE_FORAGE`,`t_ouvrage`.`Statut` AS `StatutPanne`,concat(`t_agent`.`NomAgent`,' ',`t_agent`.`PrenomsAgent`) AS `NomPrenomsAgent`,`f_getNumAppelByIDNumAppel`(`t_agent`.`IDNumAppel`) AS `NumAppel`,`t_panne`.`ALERT` AS `ALERT` from (((`t_panne` join `t_ouvrage`) join `t_region`) join `t_agent`) where ((`t_panne`.`IDOuvrage` = `t_ouvrage`.`IDOuvrage`) and (`t_ouvrage`.`IDRegion` = `t_region`.`IDRegion`) and (`t_agent`.`IDAgent` = `t_region`.`IDSociologue`) and (`t_panne`.`StatutPanne` > 3) and (cast((`t_panne`.`DatePriseCharge` + interval 3 day) as date) <= cast(now() as date)) and (`t_panne`.`ALERT` = 0)) */;
/*!50001 SET character_set_client      = @saved_cs_client */;
/*!50001 SET character_set_results     = @saved_cs_results */;
/*!50001 SET collation_connection      = @saved_col_connection */;

--
-- Final view structure for view `v_forage_hors_delai_reparation`
--

/*!50001 DROP TABLE IF EXISTS `v_forage_hors_delai_reparation`*/;
/*!50001 DROP VIEW IF EXISTS `v_forage_hors_delai_reparation`*/;
/*!50001 SET @saved_cs_client          = @@character_set_client */;
/*!50001 SET @saved_cs_results         = @@character_set_results */;
/*!50001 SET @saved_col_connection     = @@collation_connection */;
/*!50001 SET character_set_client      = latin1 */;
/*!50001 SET character_set_results     = latin1 */;
/*!50001 SET collation_connection      = latin1_swedish_ci */;
/*!50001 CREATE ALGORITHM=UNDEFINED */
/*!50013 DEFINER=`root`@`%` SQL SECURITY DEFINER */
/*!50001 VIEW `v_forage_hors_delai_reparation` AS select `t_ouvrage`.`CodeOuvrage` AS `CODE_FORAGE`,`t_ouvrage`.`Statut` AS `StatutPanne`,concat(`t_agent`.`NomAgent`,' ',`t_agent`.`PrenomsAgent`) AS `NomPrenomsAgent`,`f_getNumAppelByIDNumAppel`(`t_agent`.`IDNumAppel`) AS `NumAppel`,`t_panne`.`ALERT` AS `ALERT` from (((`t_panne` join `t_ouvrage`) join `t_region`) join `t_agent`) where ((`t_panne`.`IDOuvrage` = `t_ouvrage`.`IDOuvrage`) and (`t_ouvrage`.`IDRegion` = `t_region`.`IDRegion`) and (`t_agent`.`IDAgent` = `t_region`.`IDDR`) and (`t_panne`.`StatutPanne` >= 3) and (cast((`t_panne`.`DatePriseCharge` + interval 3 day) as date) <= cast(now() as date)) and (`t_panne`.`ALERT` = 0)) */;
/*!50001 SET character_set_client      = @saved_cs_client */;
/*!50001 SET character_set_results     = @saved_cs_results */;
/*!50001 SET collation_connection      = @saved_col_connection */;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2015-03-18 15:57:47
